#pragma rtGlobals=1macro matrix_fraction_rows_target_cols()pmatrix_fraction_rows_target_cols()proc pmatrix_fraction_rows_target_cols(str_input,str_y0,str_y1,str_output)string str_inputprompt str_input "input waves ?"string str_y0prompt str_y0 "start y ?"string str_y1prompt str_y1 "stop y ?"string str_outputprompt str_output "output waves ?"string str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")variable var_indexvariable var_index1variable var_sumvar_index = 0do	make/o/n=(dimsize($stringfromlist(var_index,str_list),0)) $(stringfromlist(var_index,str_list)+"_"+str_output) = nan	duplicate/o/r=[](str2num(str_y0),str2num(str_y1)) $stringfromlist(var_index,str_list) tempcols	var_index1 = 0	do		duplicate/o/r=[var_index1][] $stringfromlist(var_index,str_list) temprow		matrixtranspose temprow		redimension/n=-1 temprow		wavestats/q temprow		var_sum = v_sum		duplicate/o/r=[var_index1][] tempcols temp		matrixtranspose temp		redimension/n=-1 temp		wavestats/q temp		$(stringfromlist(var_index,str_list)+"_"+str_output)[var_index1] = v_sum/var_sum		var_index1+=1	while(var_index1<dimsize(tempcols,0))	copydimlabels/rows=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_"+str_output)	var_index+=1while(var_index<itemsinlist(str_list))killwaves/z tempcols,temprow,tempend