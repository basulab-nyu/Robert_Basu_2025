#pragma rtGlobals=1Macro Plot_Data_pairs()pPDp()proc pPDp(str_input,str_home,str_target)string str_inputprompt str_input "input waves ?"string str_homeprompt str_home "target string ?"string str_targetprompt str_target "matching string ?"string/g str_home_list = sortlist(wavelist(str_input,";",""),";",16)string/g str_home_print = sortlist(wavelist(str_input,"\r",""),"\r",16)string/g str_match_list = replacestring(str_home,str_home_list,str_target)string/g str_match_print = replacestring(str_home,str_home_print,str_target)print str_home_printprint str_match_printvariable/g var_index = 0displaypauseupdatesilent 1do	string/g str_home_waves = stringfromlist(var_index,str_home_list)	string/g str_match_waves = stringfromlist(var_index,str_match_list)	make/o/n=(numpnts($str_home_waves),2) $(nameofwave($str_home_waves)+"_p")	$(nameofwave($str_home_waves)+"_p")[][0] = $str_home_waves[p]	$(nameofwave($str_home_waves)+"_p")[][1] = $str_match_waves[p]	setscale/p y,0,0.5,$(nameofwave($str_home_waves)+"_p")	copydimlabels $str_home_waves, $(nameofwave($str_home_waves)+"_p")	setdimlabel 1,0,$nameofwave($str_home_waves),$(nameofwave($str_home_waves)+"_p")	setdimlabel 1,1,$nameofwave($str_match_waves),$(nameofwave($str_home_waves)+"_p")	wavestats/q $str_home_waves	make/o/n=1 $(nameofwave($str_home_waves)+"_avg") = v_avg	make/o/n=1 $(nameofwave($str_home_waves)+"_sem") = v_sem	wavestats/q $str_match_waves	make/o/n=1 $(nameofwave($str_match_waves)+"_avg") = v_avg	make/o/n=1 $(nameofwave($str_match_waves)+"_sem") = v_sem	variable/g var_pairs = 0	do		appendtograph $(nameofwave($str_home_waves)+"_p")[var_pairs][]		var_pairs+=1	while(var_pairs < dimsize($(nameofwave($str_home_waves)+"_p"),0))	variable/g var_offset = 0	do		if (var_offset == 0)			modifygraph offset($(nameofwave($str_home_waves)+"_p"))={var_index-0.25,0}		else			modifygraph offset($(nameofwave($str_home_waves)+"_p#"+num2str(var_offset)))={var_index-0.25,0}		endif		var_offset+=1	while(var_offset < dimsize($(nameofwave($str_home_waves)+"_p"),0))	appendtograph $(nameofwave($str_home_waves)+"_avg")	modifygraph offset($(nameofwave($str_home_waves)+"_avg"))={var_index-0.25,0}	modifygraph mode($(nameofwave($str_home_waves)+"_avg"))=3,marker($(nameofwave($str_home_waves)+"_avg"))=9,msize($(nameofwave($str_home_waves)+"_avg"))=5,mrkthick($(nameofwave($str_home_waves)+"_avg"))=3	errorbars $(nameofwave($str_home_waves)+"_avg") Y,wave=($(nameofwave($str_home_waves)+"_sem"),$(nameofwave($str_home_waves)+"_sem"))	appendtograph $(nameofwave($str_match_waves)+"_avg")	modifygraph offset($(nameofwave($str_match_waves)+"_avg"))={var_index+0.25,0}	modifygraph mode($(nameofwave($str_match_waves)+"_avg"))=3,marker($(nameofwave($str_match_waves)+"_avg"))=9,msize($(nameofwave($str_match_waves)+"_avg"))=5,mrkthick($(nameofwave($str_match_waves)+"_avg"))=3	errorbars $(nameofwave($str_match_waves)+"_avg") Y,wave=($(nameofwave($str_match_waves)+"_sem"),$(nameofwave($str_match_waves)+"_sem"))	var_index+=1while(var_index < itemsinlist(str_home_list))modifygraph rgb=(0,0,0)resumeupdateend