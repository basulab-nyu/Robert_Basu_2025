#pragma rtGlobals=1#include <Waves Average>Macro vectors_to_histogram_groups()pvectors_to_histogram_groups()proc pvectors_to_histogram_groups(str_input,str_sort,str_b0,str_bS,str_bN)string str_inputprompt str_input "input waves (textwave) ?"string str_sortprompt str_sort "alphanumerical sorting (byte) ?"string str_b0prompt str_b0 "first bin ?"string str_bSprompt str_bS "bin size ?"string str_bNprompt str_bN "number of bins ?"if(strlen(str_input) == 0)	str_input = "wref"endifif(strlen(str_b0) == 0)	str_b0 = "0"endifif(strlen(str_bS) == 0)	str_bS = "0.05"endifif(strlen(str_bN) == 0)	str_bN = "100"endifstring str_liststring str_namestring str_avgstring str_outputvariable var_indexvariable var_index1pauseupdatemake/o/n=(str2num(str_bN)) tempvar_index = 0do	str_list = ""	if(strlen(str_sort) == 0)		str_list = wavelist($str_input[var_index],";","")	else		str_list = sortlist(wavelist($str_input[var_index],";",""),";",str2num(str_sort))	endif	str_name = ""	str_name = $str_input[var_index]	do		str_name = str_name[0,strsearch(str_name,"*",0)-1]+str_name[strsearch(str_name,"*",0)+1,inf]	while(grepstring(str_name,"\*") == 1)	str_output = ""	str_output = str_name+"_hist"	str_output = replacestring("__",str_output,"_")	print str_output	if(itemsinlist(str_list)>0)		print replacestring(";",str_list,"\r")		make/o/n=(itemsinlist(str_list),str2num(str_bN)) $str_output = nan		//display		//movewindow 400,45,750,350		var_index1 = 0		do			temp = nan			histogram/p/c/b={str2num(str_b0),str2num(str_bS),str2num(str_bN)} $stringfromlist(var_index1,str_list),temp			$str_output[var_index1][] = temp[q]			setdimlabel 0,var_index1,$stringfromlist(var_index1,str_list),$str_output			//appendtograph $str_output[var_index1][]			var_index1+=1		while(var_index1<itemsinlist(str_list))		//modifygraph rgb = (0,0,0)		setscale/p y,str2num(str_b0),str2num(str_bS),$str_output		duplicate/o $str_output,$(str_output+"_t")		matrixtranspose $(str_output+"_t")		setscale/p x,str2num(str_b0),str2num(str_bS),$(str_output+"_t")		str_avg = ""		var_index1 = 0		do			duplicate/o/r=[][var_index1] $(str_output+"_t"),$(str_output+"_t"+num2str(var_index1))			str_avg = addlistitem(str_output+"_t"+num2str(var_index1),str_avg,";",inf)			var_index1+=1		while(var_index1<dimsize($(str_output+"_t"),1))		fWaveAverage(str_avg,"",3,0,str_output+"_avg",str_output+"_sem")		setscale/p x,str2num(str_b0),str2num(str_bS),$(str_output+"_avg")		setscale/p x,str2num(str_b0),str2num(str_bS),$(str_output+"_sem")		var_index1 = 0		do			killwaves/z $(str_output+"_t"+num2str(var_index1))			var_index1+=1		while(var_index1<dimsize($(str_output+"_t"),1))		display		movewindow 400,45,750,350		appendimage $(str_output+"_t")		modifyimage $(str_output+"_t") ctab= {0,1,Rainbow,1}		appendtograph/r $(str_output+"_avg")		modifygraph rgb($(str_output+"_avg"))=(65535,65535,65535)		modifygraph lsize($(str_output+"_avg"))=1.5		errorbars $(str_output+"_avg") SHADE= {0,0,(0,0,0,0),(65535,65535,65535,32768)},wave=($(str_output+"_sem"),$(str_output+"_sem"))		modifygraph gfrelsize = 4		label bottom "levels"		label left "samples"		label right "average"	else		print "empty"	endif	var_index+=1while(var_index<numpnts($str_input))killwaves/z temp,temp2,temp3resumeupdateend