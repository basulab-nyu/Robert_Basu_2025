#pragma rtGlobals=1macro matrix_dim_stats()pmatrix_dim_stats()proc pmatrix_dim_stats(str_input,str_dim,str_trans,str_sem,str_sdv,str_sum)string str_inputprompt str_input "input waves ?"string str_dimprompt str_dim "dimension ?"string str_transprompt str_trans "transpose ?"string str_semprompt str_sem "sem ?"string str_sdvprompt str_sdv "sdv ?"string str_sumprompt str_sum "sum ?"if(strlen(str_dim) == 0)	str_dim = "0"endifif(strlen(str_trans) == 0)	str_trans = "0"endifif(strlen(str_sem) == 0)	str_sem = "0"endifif(strlen(str_sdv) == 0)	str_sdv = "0"endifif(strlen(str_sum) == 0)	str_sum = "0"endifstring str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")variable var_indexvariable var_index1silent 1pauseupdatevar_index = 0do	if(str2num(str_dim) == 1)		make/o/n=(dimsize($stringfromlist(var_index,str_list),0)) $(stringfromlist(var_index,str_list)+"_col_avg") = nan		if(str2num(str_sem) == 1)			make/o/n=(dimsize($stringfromlist(var_index,str_list),0)) $(stringfromlist(var_index,str_list)+"_col_sem") = nan		endif		if(str2num(str_sdv) == 1)			make/o/n=(dimsize($stringfromlist(var_index,str_list),0)) $(stringfromlist(var_index,str_list)+"_col_sdv") = nan		endif		if(str2num(str_sum) == 1)			make/o/n=(dimsize($stringfromlist(var_index,str_list),0)) $(stringfromlist(var_index,str_list)+"_col_sum") = nan		endif		var_index1 = 0		do			duplicate/o/r=[var_index1][] $stringfromlist(var_index,str_list) tempwave			matrixtranspose tempwave			redimension/n=-1 tempwave			wavestats/q tempwave			$(stringfromlist(var_index,str_list)+"_col_avg")[var_index1] = v_avg			if(str2num(str_sem) == 1)				$(stringfromlist(var_index,str_list)+"_col_sem")[var_index1] = v_sem			endif			if(str2num(str_sdv) == 1)				$(stringfromlist(var_index,str_list)+"_col_sdv")[var_index1] = v_sdev			endif			if(str2num(str_sum) == 1)				$(stringfromlist(var_index,str_list)+"_col_sum")[var_index1] = v_sum			endif			var_index1+=1		while(var_index1<dimsize($stringfromlist(var_index,str_list),0))		copydimlabels/cols=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_col_avg")		if(str2num(str_sem) == 1)				copydimlabels/cols=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_col_sem")		endif		if(str2num(str_sdv) == 1)			copydimlabels/cols=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_col_sdv")		endif		if(str2num(str_sum) == 1)			copydimlabels/cols=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_col_sum")		endif		if(str2num(str_trans) == 1)			matrixtranspose $(stringfromlist(var_index,str_list)+"_col_avg")			if(str2num(str_sem) == 1)				matrixtranspose $(stringfromlist(var_index,str_list)+"_col_sem")			endif			if(str2num(str_sdv) == 1)				matrixtranspose $(stringfromlist(var_index,str_list)+"_col_sdv")			endif			if(str2num(str_sum) == 1)				matrixtranspose $(stringfromlist(var_index,str_list)+"_col_sum")			endif		endif	else		make/o/n=(dimsize($stringfromlist(var_index,str_list),1)) $(stringfromlist(var_index,str_list)+"_row_avg") = nan		if(str2num(str_sem) == 1)			make/o/n=(dimsize($stringfromlist(var_index,str_list),1)) $(stringfromlist(var_index,str_list)+"_row_sem") = nan		endif		if(str2num(str_sdv) == 1)			make/o/n=(dimsize($stringfromlist(var_index,str_list),1)) $(stringfromlist(var_index,str_list)+"_row_sdv") = nan		endif		if(str2num(str_sum) == 1)			make/o/n=(dimsize($stringfromlist(var_index,str_list),1)) $(stringfromlist(var_index,str_list)+"_row_sum") = nan		endif		var_index1 = 0		do			duplicate/o/r=[][var_index1] $stringfromlist(var_index,str_list) tempwave			wavestats/q tempwave			$(stringfromlist(var_index,str_list)+"_row_avg")[var_index1] = v_avg			if(str2num(str_sem) == 1)				$(stringfromlist(var_index,str_list)+"_row_sem")[var_index1] = v_sem			endif			if(str2num(str_sdv) == 1)				$(stringfromlist(var_index,str_list)+"_row_sdv")[var_index1] = v_sdev			endif			if(str2num(str_sum) == 1)				$(stringfromlist(var_index,str_list)+"_row_sum")[var_index1] = v_sum			endif			var_index1+=1		while(var_index1<dimsize($stringfromlist(var_index,str_list),1))		copydimlabels/rows=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_row_avg")		if(str2num(str_sem) == 1)				copydimlabels/rows=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_row_sem")		endif		if(str2num(str_sdv) == 1)			copydimlabels/rows=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_row_sdv")		endif		if(str2num(str_sum) == 1)			copydimlabels/rows=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_row_sum")		endif		if(str2num(str_trans) == 1)			matrixtranspose $(stringfromlist(var_index,str_list)+"_row_avg")			if(str2num(str_sem) == 1)				matrixtranspose $(stringfromlist(var_index,str_list)+"_row_sem")			endif			if(str2num(str_sdv) == 1)				matrixtranspose $(stringfromlist(var_index,str_list)+"_row_sdv")			endif			if(str2num(str_sum) == 1)				matrixtranspose $(stringfromlist(var_index,str_list)+"_row_sdv")			endif		endif	endif	var_index+=1while(var_index<itemsinlist(str_list))resumeupdatekillwaves/z tempwaveend