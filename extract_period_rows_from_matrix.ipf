#pragma rtGlobals=1Macro extract_period_rows_from_matrix()pextract_period_rows_from_matrix()proc pextract_period_rows_from_matrix(str_input,str_txt,str_period)string str_inputprompt str_input "input data waves ?"string str_txtprompt str_txt "input text waves ?"string str_periodprompt str_period "period ?"string str_list = sortlist(wavelist(str_input,";",""),";",16)string str_ref = sortlist(wavelist(str_txt,";",""),";",16)print replacestring(";",str_list,"\r")print replacestring(";",str_ref,"\r")string str_reg = "_([A-F,a-f]{1,2}|[A-F,a-f]{1}+[2]{1})_.*_(vs)_.*_([A-F,a-f]{1,2}|[A-F,a-f]{1}+[2]{1})_"string str_lbl1string str_lbl2string str_lbl3string str_lbl_listvariable var_indexvariable var_index1variable var_index2var_index = 0do	str_lbl_list = ""	var_index1 = 0	do		var_index2 = 0		do			str_lbl1 = ""			str_lbl2 = ""			str_lbl3 = ""			splitstring/e=str_reg $stringfromlist(var_index,str_ref)[var_index1][var_index2],str_lbl1,str_lbl2,str_lbl3			var_index2+=1		while(strlen(str_lbl1) == 0 || strlen(str_lbl2) == 0 || strlen(str_lbl3) == 0)		str_lbl_list = addlistitem(str_lbl1+"_"+str_lbl2+"_"+str_lbl3,str_lbl_list,";",inf)		var_index1+=1	while(var_index1<str2num(str_period))	var_index1 = 0	do		make/o/n=(dimsize($stringfromlist(var_index,str_list),0)/str2num(str_period),dimsize($stringfromlist(var_index,str_list),1)) $(stringfromlist(var_index,str_list)+"_"+stringfromlist(var_index1,str_lbl_list)) = nan		make/o/t/n=(dimsize($stringfromlist(var_index,str_ref),0)/str2num(str_period),dimsize($stringfromlist(var_index,str_ref),1)) $(stringfromlist(var_index,str_ref)+"_"+stringfromlist(var_index1,str_lbl_list))		$(stringfromlist(var_index,str_ref)+"_"+stringfromlist(var_index1,str_lbl_list)) = ""		var_index2 = 0		do			$(stringfromlist(var_index,str_list)+"_"+stringfromlist(var_index1,str_lbl_list))[var_index2][] = $stringfromlist(var_index,str_list)[var_index1+var_index2*str2num(str_period)][q]			$(stringfromlist(var_index,str_ref)+"_"+stringfromlist(var_index1,str_lbl_list))[var_index2][] = $stringfromlist(var_index,str_ref)[var_index1+var_index2*str2num(str_period)][q]			var_index2+=1		while(var_index2<dimsize($stringfromlist(var_index,str_list),0)/str2num(str_period))		var_index1+=1	while(var_index1<itemsinlist(str_lbl_list))	var_index+=1while(var_index<itemsinlist(str_list))end