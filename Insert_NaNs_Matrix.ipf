#pragma rtGlobals=1Macro Insert_NaN_Matrix()pInsert_NaN_Matrix()proc pInsert_NaN_Matrix(str_input,str_dim,str_idx,str_nb,str_output)string str_inputprompt str_input "input waves ?"string str_dimprompt str_dim "dimension ?"string str_idxprompt str_idx "insertion index ?"string str_nbprompt str_nb "number of points to insert ?"string str_outputprompt str_output "output waves ?"string str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")variable var_indexvar_index = 0do	duplicate/o $stringfromlist(var_index,str_list) $(stringfromlist(var_index,str_list)+"_"+str_output)	insertpoints/m=(str2num(str_dim))/v=nan str2num(str_idx),str2num(str_nb),$(stringfromlist(var_index,str_list)+"_"+str_output)	var_index+=1while(var_index<itemsinlist(str_list))end