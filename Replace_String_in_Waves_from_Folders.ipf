#pragma rtGlobals=1macro Replace_String_in_Waves_from_Folders()pReplace_String_in_Waves_from_Folders()proc pReplace_String_in_Waves_from_Folders(str_input,str_start,str_stop)string str_inputprompt str_input "input folders ?"string str_startprompt str_start "string start byte ?"string str_stopprompt str_stop "string stop byte ?"setdatafolder root:string str_liststring str_sublistvariable var_indexvariable var_subindexsilent 1pauseupdatestr_list = ""var_index = 0do	str_list = addlistitem(getindexedobjname("",4,var_index),str_list,";",var_index)	var_index+=1while(var_index<countobjects("",4))str_list = removefromlist("Packages",str_list)str_list = listmatch(str_list,str_input)str_list = sortlist(str_list,";",16)print replacestring(";",str_list,"\r")var_index = 0do	setdatafolder root:$stringfromlist(var_index,str_list)	str_sublist = ""	var_subindex = 0	do		if(stringmatch(stringfromlist(var_subindex,wavelist("*",";","")),"*"+stringfromlist(var_index,str_list)[str2num(str_start),str2num(str_stop)]+"*") == 1)			rename $stringfromlist(var_subindex,wavelist("*",";","")),$(replacestring(stringfromlist(var_index,str_list)[str2num(str_start),str2num(str_stop)],stringfromlist(var_subindex,wavelist("*",";","")),stringfromlist(var_index,str_list))[0,strsearch(stringfromlist(var_subindex,wavelist("*",";","")),stringfromlist(var_index,str_list)[str2num(str_start),str2num(str_stop)],0)+strlen(stringfromlist(var_index,str_list))-1])		endif		var_subindex+=1	while(var_subindex<itemsinlist(wavelist("*",";","")))	var_index+=1while(var_index<itemsinlist(str_list))setdatafolder root:end