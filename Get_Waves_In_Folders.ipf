#pragma rtGlobals=1Macro Get_Waves_In_Folders()pGWIF()proc pGWIF(str_input,str_grep)string str_inputprompt str_input "input waves ?"string str_grepprompt str_grep "grep selection ?"if(strlen(str_grep) == 0)	string/g str_grep = "."endifvariable/g var_Fcount = countobjects("",4)string/g str_Flistif(itemsinlist(str_Flist)!=0)	killstrings str_Flistendifstring/g str_Flistvariable/g var_Fscroll = 0silent 1pauseupdatedo	str_Flist = addlistitem(getindexedobjname("", 4, var_Fscroll),str_Flist,";",var_Fscroll)	var_Fscroll+=1while(var_Fscroll<var_Fcount)variable/g var_Nwave_ck = 0make/o/n=(var_Fcount) w_Wcount = nando	string/g str_Fbrowse_ck = stringfromlist(var_Nwave_ck,str_Flist)	string/g str_Fbrowse_ck_lcl = str_Fbrowse_ck	variable/g var_Nwave_ck_lcl = var_Nwave_ck	setdatafolder(str_Fbrowse_ck)	if (exists("var_Nwave_ck_lcl") == 2)		killvariables var_Nwave_ck_lcl	endif	if (exists("w_Wcount") == 1)		killwaves w_Wcount	endif	if (exists("str_Fbrowse_ck_lcl") == 2)		killstrings str_Fbrowse_ck_lcl	endif	setdatafolder root:	movewave root:w_Wcount, root:$(str_Fbrowse_ck):	movevariable root:var_Nwave_ck_lcl, root:$(str_Fbrowse_ck):	movestring root:str_Fbrowse_ck_lcl, root:$(str_Fbrowse_ck):	setdatafolder(str_Fbrowse_ck)	if(strlen(greplist(wavelist(str_input,";",""),str_grep))==0)		setdimlabel 0,var_Nwave_ck_lcl,$str_Fbrowse_ck_lcl,w_Wcount		movewave w_Wcount, root:		killvariables var_Nwave_ck_lcl	else		w_Wcount[var_Nwave_ck_lcl] = itemsinlist(greplist(wavelist(str_input,";",""),str_grep))		setdimlabel 0,var_Nwave_ck_lcl,$str_Fbrowse_ck_lcl,w_Wcount		movewave w_Wcount, root:		killvariables var_Nwave_ck_lcl	endif	setdatafolder root:	var_Nwave_ck+=1while (var_Nwave_ck<var_Fcount)wavestats/q w_Wcountvariable/g var_Wcount = v_summake/o/t/n=(var_Wcount,var_Fcount) m_fld_wavvariable/g var_Fscroll = 0do	string/g str_Fbrowse = stringfromlist(var_Fscroll,str_Flist)	variable/g var_Fscroll_lcl = var_Fscroll	string/g str_Fbrowse_lcl = str_Fbrowse	setdatafolder(str_Fbrowse)	if (exists("m_fld_wav") == 1)		killwaves m_fld_wav	endif	if (exists("var_Fscroll_lcl") == 2)		killvariables var_Fscroll_lcl	endif	if (exists("str_Fbrowse_lcl") == 2)		killstrings str_Fbrowse_lcl	endif	setdatafolder root:	movewave root:m_fld_wav, root:$(str_Fbrowse):	movevariable root:var_Fscroll_lcl, root:$(str_Fbrowse):	movestring root:str_Fbrowse_lcl, root:$(str_Fbrowse):	setdatafolder(str_Fbrowse)	string/g str_wavelist = greplist(wavelist(str_input,";",""),str_grep)	variable/g var_Wscroll = 0	do		if(strlen(str_wavelist)==0)			break		endif		string/g str_wave = stringfromlist(var_Wscroll,str_wavelist)		duplicate $str_wave, $(nameofwave($str_wave)+"_move")		m_fld_wav[var_Wscroll][var_Fscroll_lcl] = nameofwave($str_wave)		setdimlabel 1,var_Fscroll_lcl,$str_Fbrowse_lcl,m_fld_wav		movewave $(nameofwave($str_wave)+"_move"), root:$str_wave		var_Wscroll+=1	while(var_Wscroll<itemsinlist(str_wavelist))	movewave m_fld_wav, root:	setdatafolder root:	var_Fscroll+=1while(var_Fscroll<var_Fcount)end