#pragma rtglobals=1macro RaRmCm_topgraph()pRaRmCm_topgraph()proc pRaRmCm_topgraph(str_i,str_output)string str_iprompt str_i "step(mV)?"string str_outputprompt str_output "output?"if(strlen(str_i) == 0)	str_i = "5"endifif(strlen(str_output) == 0)	str_output = "RaRmCm"endifvariable var_i = str2num(str_i)*10^(-3)string str_liststring str_base_namevariable var_indexvariable var_b0variable var_b1variable var_s0variable var_s1variable var_bottomvariable var_toppauseupdatestr_list = listmatch(sortlist(tracenamelist("",";",1),";",16),"*fit*")if(itemsinlist(str_list)>0)	var_index = 0	do		do			checkdisplayed $stringfromlist(var_index,str_list)			removefromgraph/z $stringfromlist(var_index,str_list)			killwaves/z $stringfromlist(var_index,str_list)		while(v_flag == 1)		var_index+=1	while(var_index<itemsinlist(str_list))endifresumeupdatestr_list = sortlist(tracenamelist("",";",1),";",16)print replacestring(";",str_list,"\r")if(strlen(csrinfo(A)) == 0 || strlen(csrinfo(B)) == 0 || strlen(csrinfo(C)) == 0 || strlen(csrinfo(D)) == 0)	cursor/p A $stringfromlist(0,str_list) 825	cursor/p B $stringfromlist(0,str_list) 1075	cursor/p C $stringfromlist(0,str_list) 1825	cursor/p D $stringfromlist(0,str_list) 2075endifmake/o/n=4 w_sort = NaNw_sort[0] = xcsr(A)w_sort[1] = xcsr(B)w_sort[2] = xcsr(C)w_sort[3] = xcsr(D)sort w_sort, w_sortvar_b0 = w_sort[0]var_b1 = w_sort[1]var_s0 = w_sort[2]var_s1 = w_sort[3]make/o/n=(itemsinlist(str_list),12) $str_output = NaNsetdimlabel 1,0,base_c,$str_outputsetdimlabel 1,1,base_t,$str_outputsetdimlabel 1,2,ini_c,$str_outputsetdimlabel 1,3,ini_t,$str_outputsetdimlabel 1,4,ini_delta_c,$str_outputsetdimlabel 1,5,ss_c,$str_outputsetdimlabel 1,6,ss_t,$str_outputsetdimlabel 1,7,ss_delta_c,$str_outputsetdimlabel 1,8,tau,$str_outputsetdimlabel 1,9,Ra,$str_outputsetdimlabel 1,10,Rm,$str_outputsetdimlabel 1,11,Cm,$str_outputvar_index = 0pauseupdatedo	wavestats/q/r=(var_b0,var_b1) $stringfromlist(var_index,str_list)	$str_output[var_index][%base_c] = v_avg	$str_output[var_index][%base_t] = 0.5*(var_b1-var_b0)+var_b0	wavestats/q/r=(var_b1,var_s0) $stringfromlist(var_index,str_list)	$str_output[var_index][%ini_c] = v_min	$str_output[var_index][%ini_t] = v_minloc	$str_output[var_index][%ini_delta_c] = abs($str_output[var_index][%ini_c] - $str_output[var_index][%base_c])	wavestats/q/r=(var_s0,var_s1) $stringfromlist(var_index,str_list)	$str_output[var_index][%ss_c] = v_avg	$str_output[var_index][%ss_t] = 0.5*(var_s1-var_s0)+var_s0	$str_output[var_index][%ss_delta_c] = abs($str_output[var_index][%ss_c] - $str_output[var_index][%base_c])	curvefit/q/w=2 dblexp_xoffset,$stringfromlist(var_index,str_list)($str_output[var_index][%ini_t],$str_output[var_index][%ss_t])/d	modifygraph rgb($("fit_"+stringfromlist(var_index,str_list)))=(36873,14755,58982)	$str_output[var_index][%tau] = ((w_coef[1]* w_coef[2])+(w_coef[3]*w_coef[4]))/(w_coef[1]+w_coef[3])	$str_output[var_index][%Ra] = var_i*10^(6)/$str_output[var_index][%ini_delta_c]	$str_output[var_index][%Rm] = var_i*10^(6)/$str_output[var_index][%ss_delta_c]	$str_output[var_index][%Rm] = $str_output[var_index][%Rm]-$str_output[var_index][%Ra]	$str_output[var_index][%Cm] = $str_output[var_index][%tau]*10^(-9)/($str_output[var_index][%Ra]+$str_output[var_index][%Rm])	$str_output[var_index][%Cm] = $str_output[var_index][%Cm]*10^(12)	setdimlabel 0,var_index,$stringfromlist(var_index,str_list),$str_output	var_index+=1while(var_index<itemsinlist(str_list))appendtograph $str_output[][%base_c] vs $str_output[][%base_t]modifygraph mode($str_output)=3,rgb($str_output)=(2,39321,1)appendtograph $str_output[][%ini_c] vs $str_output[][%ini_t]modifygraph mode($(str_output+"#1"))=3,rgb($(str_output+"#1"))=(65535,0,0)appendtograph $str_output[][%ss_c] vs $str_output[][%ss_t]modifygraph mode($(str_output+"#2"))=3,rgb($(str_output+"#2"))=(65535,21845,0)setaxis bottom 75,250make/o/n=(dimsize($str_output,0)) temp = nantemp = $str_output[p][%ini_c]wavestats/q tempvar_bottom = v_min-50var_top = 0-var_bottomsetaxis left var_bottom,var_topresumeupdatekillwaves/z w_sort,w_coef,w_sigma,w_fitconstants,w_sweep_name,w_base_sweeps,temp,tempcolcursor/k Acursor/k Bcursor/k Ccursor/k Dcursor/k Ecursor/k Fedit $str_output.ldmovewindow 327.75,396.5,1146.75,630.5end