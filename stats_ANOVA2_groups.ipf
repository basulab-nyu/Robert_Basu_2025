#pragma rtGlobals=1Macro ANOVA_2_way_groups()p2wAg()proc p2wAg(str_groups,str_lbl,str_output)string str_groupsprompt str_groups "groups textwave ?"string str_lblprompt str_lbl "groups textwave ?"string str_outputprompt str_output "output waves ?"if(strlen(str_groups) == 0)	str_groups = "w_ANOVA_input"endifif(strlen(str_lbl) == 0)	str_lbl = "w_ANOVA_labels"endifsilent 1pauseupdateif(exists("str_list_total")==2)	killstrings/z str_list_totalendifif(exists("str_metalist")==2)	killstrings/z str_metalistendifstring/g str_list_totalmake/o/t/n=(0,numpnts($str_groups)) $(str_output+"_groups")variable/g var_max_list_size = 0variable/g var_collect = 0do	string/g $("str_list"+num2str(var_collect)) = sortlist(wavelist($str_groups[var_collect],";",""),";",16)	var_max_list_size = max(var_max_list_size,itemsinlist(sortlist(wavelist($str_groups[var_collect],";",""),";",16)))	redimension/n=(var_max_list_size,numpnts($str_groups)) $(str_output+"_groups")	str_list_total = str_list_total + $("str_list"+num2str(var_collect))	if(var_collect == 0)		string/g str_metalist = "str_list"+num2str(var_collect)	else		str_metalist = str_metalist+";str_list"+num2str(var_collect)	endif	$(str_output+"_groups")[][var_collect] = stringfromlist(p,sortlist(wavelist($str_groups[var_collect],";",""),";",16),";")	var_collect+=1while(var_collect<numpnts($str_groups))variable/g var_x_size = 0variable/g var_y_size = numpnts($str_groups)variable/g var_z_size = itemsinlist(str_list0)variable/g var_index = 0do	wavestats/q $stringfromlist(var_index,str_list_total)	if (var_x_size < v_endrow+1)		var_x_size = v_endrow+1	endif	print "\rJarque-Bera test :"	print stringfromlist(var_index,str_list_total)	statsjbtest/z $stringfromlist(var_index,str_list_total)	if (w_jbresults[%JBStatistic] >= w_jbresults[%Critical])		print "no normality"	endif	var_index = var_index + 1while (var_index < itemsinlist(str_list_total))print "\rBarlett test :"print str_list_totalstatsvariancestest/z/wstr=str_list_totalif (w_statsvariancestest[%Bartlett_T] >= w_statsvariancestest[%Critical])	print "no homoscedasticity"endifvariable/g var_index = 0make/o/n=(var_x_size,var_y_size,var_z_size) $(str_output+"_m")do	variable/g var_col = 0	do		$(str_output+"_m")[][var_col][var_index] = $stringfromlist(var_index,$stringfromlist(var_col,str_metalist))[p]		string/g str_dim2_name = str_output+"_"+stringfromlist(var_index,str_list0)[strsearch($str_groups[0],"*",0),strsearch($str_groups[0],"*",0)+strlen(stringfromlist(var_index,str_list0))-strlen($str_groups[0])]		setdimlabel 2,var_index,$str_dim2_name,$(str_output+"_m")		string/g str_dim1_name = $str_lbl[var_col]		setdimlabel 1,var_col,$str_dim1_name,$(str_output+"_m")		variable/g var_row = 0		do			string/g str_dim0_name = str_output+"_"+num2str(var_row)			setdimlabel 0,var_row,$str_dim0_name,$(str_output+"_m")			var_row+=1		while(var_row<dimsize($(str_output+"_m"),0))		var_col+=1	while (var_col < var_y_size)	var_index+=1while (var_index < var_z_size)variable/g var_index = 0variable/g var_tot = dimsize($(str_output+"_m"),2)do	duplicate/o/r=[][][var_index] $(str_output+"_m") $(getdimlabel($(str_output+"_m"),2,var_index)+"_m")	redimension/n=(-1,-1,0) $(getdimlabel($(str_output+"_m"),2,var_index)+"_m")	wavestats/q $(getdimlabel($(str_output+"_m"),2,var_index)+"_m")	if (v_numnans != 0)		print getdimlabel($(str_output+"_m"),2,var_index) + " excluded because contains NaNs"		deletepoints/m=2 var_index,1,$(str_output+"_m")		var_index-=1	endif	if (v_numinfs != 0)		print getdimlabel($(str_output+"_m"),2,var_index) + " excluded because contains INFs"		deletepoints/m=2 var_index,1,$(str_output+"_m")		var_index-=1	endif	var_index+=1while (var_index < dimsize($(str_output+"_m"),2))statsanova2test/modl=1 $(str_output+"_m")print str_list_totalprint "\rRepeated-measures ANOVA :"print "Factor A, p = "print 1-statsfcdf(m_anova2results[%factor_A][%F],m_anova2results[%factor_A][%DF],m_anova2results[%error_within_cells][%DF])print "Factor B, p = "print 1-statsfcdf(m_anova2results[%factor_B][%F],m_anova2results[%factor_B][%DF],m_anova2results[%error_within_cells][%DF])print "Factor AxB, p = "print 1-statsfcdf(m_anova2results[%A_x_B][%F],m_anova2results[%A_x_B][%DF],m_anova2results[%error_within_cells][%DF])make/o/n=3 $("w2Ap_"+str_output)$("w2Ap_"+str_output)[0] = 1-statsfcdf(m_anova2results[%factor_A][%F],m_anova2results[%factor_A][%DF],m_anova2results[%error_within_cells][%DF])$("w2Ap_"+str_output)[1] = 1-statsfcdf(m_anova2results[%factor_B][%F],m_anova2results[%factor_B][%DF],m_anova2results[%error_within_cells][%DF])$("w2Ap_"+str_output)[2] = 1-statsfcdf(m_anova2results[%A_x_B][%F],m_anova2results[%A_x_B][%DF],m_anova2results[%error_within_cells][%DF])setdimlabel 0,0,$("Factor A"),$("w2Ap_"+str_output)setdimlabel 0,1,$("Factor B"),$("w2Ap_"+str_output)setdimlabel 0,2,$("Factor AxB"),$("w2Ap_"+str_output)//edit $("w2Ap_"+str_output).ldvariable/g var_index = 0do	duplicate/o/r=[][var_index][] $(str_output+"_m") tempB	matrixop/o tempBt = transposevol(tempB,2)	duplicate/o tempBt $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_fB")	copydimlabels/ROWS=1/LAYR=0 $(str_output+"_m"), $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_fB")	variable/g var_scroll = 0	do		if(var_scroll == 0)			duplicate/o $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_fB") tempM			duplicate/o/r=[][var_scroll] tempM $(getdimlabel(tempM,1,var_scroll)+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_w_fB")			string/g str_stats = nameofwave($(getdimlabel(tempM,1,var_scroll)+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_w_fB"))			if(var_index == 0)				string/g str_catch = getdimlabel($(str_output+"_m"),1,var_index)			endif		else			duplicate/o $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_fB") tempM			duplicate/o/r=[][var_scroll] tempM $(getdimlabel(tempM,1,var_scroll)+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_w_fB")			str_stats = str_stats+";"+nameofwave($(getdimlabel(tempM,1,var_scroll)+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_w_fB"))		endif		var_scroll+=1	while(var_scroll<dimsize($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_fB"),1))	statstukeytest/swn/wstr=str_stats	duplicate/o m_tukeytestresults $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p")	duplicate/o t_tukeydescriptors $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p_t")	variable/g var_label = 0	do		string/g str_relabel = $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p_t")[var_label]		if(strsearch(str_relabel," vs ",0) != -1)			str_relabel = replacestring(" vs ",str_relabel,"_vs_")		endif		string/g str_relabel1 = str_relabel[0,strsearch(str_relabel,"vs",0)-1]		string/g str_relabel2 = str_relabel[strlen(str_relabel1)+3,inf]		if(cmpstr(str_relabel1,str_relabel2) == 1)			str_relabel = str_relabel2+"_vs_"+str_relabel1		endif		$(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p_t")[var_label] = str_relabel		setdimlabel 0,var_label,$($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p_t")[var_label]),$(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p")		var_label+=1	while(var_label<dimsize($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p"),0))	statsnpmctest/swn/tuk/wstr=str_stats	duplicate/o m_npmctukeyresults $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np")	duplicate/o t_npmctukeydescriptors $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np_t")	variable/g var_label = 0	do		string/g str_relabel = $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np_t")[var_label]		if(strsearch(str_relabel," vs ",0) != -1)			str_relabel = replacestring(" vs ",str_relabel,"_vs_")		endif		string/g str_relabel1 = str_relabel[0,strsearch(str_relabel,"vs",0)-1]		string/g str_relabel2 = str_relabel[strlen(str_relabel1)+3,inf]		if(cmpstr(str_relabel1,str_relabel2) == 1)			str_relabel = str_relabel2+"_vs_"+str_relabel1		endif		$(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np_t")[var_label] = str_relabel		setdimlabel 0,var_label,$($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np_t")[var_label]),$(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np")		var_label+=1	while(var_label<dimsize($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np"),0))	killwaves/z tempB, tempBt, tempM	if(var_index == 0)		make/o/n=(dimsize($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p"),0),dimsize($(str_output+"_m"),1)) $(str_output+"_m_fB_tuk_p_sig") = nan		make/o/n=(dimsize($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np"),0),dimsize($(str_output+"_m"),1)) $(str_output+"_m_fB_tuk_np_sig") = nan		duplicate/o $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p"),tempsort		tempsort=tempsort[p][%P]		redimension/n=(dimsize(tempsort,0)) tempsort		sort/a=1/diml $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p_t"),$(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p_t"),tempsort		$(str_output+"_m_fB_tuk_p_sig")[][var_index] = tempsort[p]		copydimlabels/ROWS=0 tempsort, $(str_output+"_m_fB_tuk_p_sig")		duplicate/o $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np"),tempsort		tempsort=tempsort[p][%Conclusion]		redimension/n=(dimsize(tempsort,0)) tempsort		sort/a=1/diml $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np_t"),$(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np_t"),tempsort		$(str_output+"_m_fB_tuk_np_sig")[][var_index] = tempsort[p]		copydimlabels/ROWS=0 tempsort, $(str_output+"_m_fB_tuk_np_sig")		setdimlabel 1,var_index,$nameofwave($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p")),$(str_output+"_m_fB_tuk_p_sig")		string/g str_fB_check_p = nameofwave($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p"))		setdimlabel 1,var_index,$nameofwave($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np")),$(str_output+"_m_fB_tuk_np_sig")		string/g str_fB_check_np = nameofwave($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np"))	else		duplicate/o $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p"),tempsort		tempsort=tempsort[p][%P]		redimension/n=(dimsize(tempsort,0)) tempsort		sort/a=1/diml $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p_t"),$(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p_t"),tempsort		$(str_output+"_m_fB_tuk_p_sig")[][var_index] = tempsort[p]		duplicate/o $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np"),tempsort		tempsort=tempsort[p][%Conclusion]		redimension/n=(dimsize(tempsort,0)) tempsort		sort/a=1/diml $(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np_t"),$(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np_t"),tempsort		$(str_output+"_m_fB_tuk_np_sig")[][var_index] = tempsort[p]		setdimlabel 1,var_index,$nameofwave($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_p")),$(str_output+"_m_fB_tuk_p_sig")		setdimlabel 1,var_index,$nameofwave($(str_output+"_"+getdimlabel($(str_output+"_m"),1,var_index)+"_m_tuk_np")),$(str_output+"_m_fB_tuk_np_sig")	endif	var_index+=1while(var_index<dimsize($(str_output+"_m"),1))variable/g var_index = 0do	duplicate/o/r=[var_index][][] $(str_output+"_m") tempA	matrixop/o tempAt = transposevol(tempA,3)	duplicate/o tempAt $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_fA")	copydimlabels/COLS=1/LAYR=0 $(str_output+"_m"), $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_fA")	variable/g var_scroll = 0	do		if(var_scroll == 0)			duplicate/o $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_fA") tempM			duplicate/o/r=[][var_scroll] tempM $(getdimlabel($(str_output+"_m"),0,var_index)+"_"+getdimlabel(tempM,1,var_scroll)+"_w_fA")			string/g str_stats = nameofwave($(getdimlabel($(str_output+"_m"),0,var_index)+"_"+getdimlabel(tempM,1,var_scroll)+"_w_fA"))		else			duplicate/o $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_fA") tempM			duplicate/o/r=[][var_scroll] tempM $(getdimlabel($(str_output+"_m"),0,var_index)+"_"+getdimlabel(tempM,1,var_scroll)+"_w_fA")			str_stats = str_stats+";"+nameofwave($(getdimlabel($(str_output+"_m"),0,var_index)+"_"+getdimlabel(tempM,1,var_scroll)+"_w_fA"))		endif		var_scroll+=1	while(var_scroll<dimsize($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_fA"),1))	statstukeytest/swn/wstr=str_stats	duplicate/o m_tukeytestresults $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p")	duplicate/o t_tukeydescriptors $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p_t")	variable/g var_label = 0	do		string/g str_relabel = $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p_t")[var_label]		if(strsearch(str_relabel," vs ",0) != -1)			str_relabel = replacestring(" vs ",str_relabel,"_vs_")		endif		string/g str_relabel1 = str_relabel[0,strsearch(str_relabel,"vs",0)-1]		string/g str_relabel2 = str_relabel[strlen(str_relabel1)+3,inf]		if(cmpstr(str_relabel1,str_relabel2) == 1)			str_relabel = str_relabel2+"_vs_"+str_relabel1		endif		$(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p_t")[var_label] = str_relabel		setdimlabel 0,var_label,$($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p_t")[var_label]),$(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p")		var_label+=1	while(var_label<dimsize($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p"),0))	statsnpmctest/swn/tuk/wstr=str_stats	duplicate/o m_npmctukeyresults $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np")	duplicate/o t_npmctukeydescriptors $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np_t")	variable/g var_label = 0	do		string/g str_relabel = $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np_t")[var_label]		if(strsearch(str_relabel," vs ",0) != -1)			str_relabel = replacestring(" vs ",str_relabel,"_vs_")		endif		string/g str_relabel1 = str_relabel[0,strsearch(str_relabel,"vs",0)-1]		string/g str_relabel2 = str_relabel[strlen(str_relabel1)+3,inf]		if(cmpstr(str_relabel1,str_relabel2) == 1)			str_relabel = str_relabel2+"_vs_"+str_relabel1		endif		$(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np_t")[var_label] = str_relabel		setdimlabel 0,var_label,$($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np_t")[var_label]),$(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np")		var_label+=1	while(var_label<dimsize($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np"),0))	killwaves/z tempA, tempAt, tempM	if(var_index == 0)		make/o/n=(dimsize($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p"),0),dimsize($(str_output+"_m"),0)) $(str_output+"_m_fA_tuk_p_sig") = nan		make/o/n=(dimsize($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np"),0),dimsize($(str_output+"_m"),0)) $(str_output+"_m_fA_tuk_np_sig") = nan		duplicate/o $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p"),tempsort		tempsort=tempsort[p][%P]		redimension/n=(dimsize(tempsort,0)) tempsort		sort/a=1/diml $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p_t"),$(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p_t"),tempsort		$(str_output+"_m_fA_tuk_p_sig")[][var_index] = tempsort[p]		copydimlabels/ROWS=0 tempsort, $(str_output+"_m_fA_tuk_p_sig")		duplicate/o $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np"),tempsort		tempsort=tempsort[p][%Conclusion]		redimension/n=(dimsize(tempsort,0)) tempsort		sort/a=1/diml $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np_t"),$(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np_t"),tempsort		$(str_output+"_m_fA_tuk_np_sig")[][var_index] = tempsort[p]		copydimlabels/ROWS=0 tempsort, $(str_output+"_m_fA_tuk_np_sig")		string/g str_fA_check_p = nameofwave($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p"))		setdimlabel 1,var_index,$nameofwave($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p")),$(str_output+"_m_fA_tuk_p_sig")		string/g str_fA_check_np = nameofwave($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np"))		setdimlabel 1,var_index,$nameofwave($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np")),$(str_output+"_m_fA_tuk_np_sig")	else		duplicate/o $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p"),tempsort		tempsort=tempsort[p][%P]		redimension/n=(dimsize(tempsort,0)) tempsort		sort/a=1/diml $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p_t"),$(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p_t"),tempsort		$(str_output+"_m_fA_tuk_p_sig")[][var_index] = tempsort[p]		duplicate/o $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np"),tempsort		tempsort=tempsort[p][%Conclusion]		redimension/n=(dimsize(tempsort,0)) tempsort		sort/a=1/diml $(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np_t"),$(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np_t"),tempsort		$(str_output+"_m_fA_tuk_np_sig")[][var_index] = tempsort[p]		setdimlabel 1,var_index,$nameofwave($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_p")),$(str_output+"_m_fA_tuk_p_sig")		setdimlabel 1,var_index,$nameofwave($(getdimlabel($(str_output+"_m"),0,var_index)+"_m_tuk_np")),$(str_output+"_m_fA_tuk_np_sig")	endif	var_index+=1while(var_index<dimsize($(str_output+"_m"),0))matrixtranspose $(str_output+"_m_fA_tuk_p_sig")matrixtranspose $(str_output+"_m_fA_tuk_np_sig")make/o/t/n=(dimsize($(str_output+"_m_fA_tuk_p_sig"),0)) $(str_output+"_m_fA_tuk_p_xlbl")make/o/n=(dimsize($(str_output+"_m_fA_tuk_p_sig"),0)) $(str_output+"_m_fA_tuk_p_xloc") = xmake/o/t/n=(dimsize($(str_output+"_m_fA_tuk_np_sig"),0)) $(str_output+"_m_fA_tuk_np_xlbl")make/o/n=(dimsize($(str_output+"_m_fA_tuk_np_sig"),0)) $(str_output+"_m_fA_tuk_np_xloc") = xmake/o/t/n=(dimsize($(str_output+"_m_fA_tuk_p_sig"),1)) $(str_output+"_m_fA_tuk_p_ylbl")make/o/n=(dimsize($(str_output+"_m_fA_tuk_p_sig"),1)) $(str_output+"_m_fA_tuk_p_yloc") = xmake/o/t/n=(dimsize($(str_output+"_m_fA_tuk_np_sig"),1)) $(str_output+"_m_fA_tuk_np_ylbl")make/o/n=(dimsize($(str_output+"_m_fA_tuk_np_sig"),1)) $(str_output+"_m_fA_tuk_np_yloc") = xvariable/g var_label = 0do	string/g str_p_exc_fA_x=getdimlabel($(str_output+"_m_fA_tuk_p_sig"),0,var_label)	str_p_exc_fA_x = replacestring(str_output,str_p_exc_fA_x,"")	str_p_exc_fA_x = replacestring("m_tuk_p",str_p_exc_fA_x,"")	str_p_exc_fA_x = replacestring("_",str_p_exc_fA_x,"")	str_p_exc_fA_x = replacestring("vs",str_p_exc_fA_x,"_vs_")	string/g str_np_exc_fA_x=getdimlabel($(str_output+"_m_fA_tuk_np_sig"),0,var_label)	str_np_exc_fA_x = replacestring(str_output,str_np_exc_fA_x,"")	str_np_exc_fA_x = replacestring("m_tuk_np",str_np_exc_fA_x,"")	str_np_exc_fA_x = replacestring("_",str_np_exc_fA_x,"")	str_np_exc_fA_x = replacestring("vs",str_np_exc_fA_x,"_vs_")	$(str_output+"_m_fA_tuk_p_xlbl")[var_label]=str_p_exc_fA_x	$(str_output+"_m_fA_tuk_np_xlbl")[var_label]=str_np_exc_fA_x	var_label+=1while(var_label<dimsize($(str_output+"_m_fA_tuk_p_sig"),0))variable/g var_label = 0do	string/g str_p_exc_fA_y=getdimlabel($(str_output+"_m_fA_tuk_p_sig"),1,var_label)	str_p_exc_fA_y = replacestring(str_output,str_p_exc_fA_y,"")	str_p_exc_fA_y = replacestring("w_fA",str_p_exc_fA_y,"")	str_p_exc_fA_y = replacestring("_",str_p_exc_fA_y,"")	str_p_exc_fA_y = replacestring("vs",str_p_exc_fA_y,"_vs_")	variable/g var_scan = 0	do		if(numtype(str2num(str_p_exc_fA_y[var_scan])) != 2)			if(var_scan == 0)				str_p_exc_fA_y = str_p_exc_fA_y[var_scan+1,inf]			else				str_p_exc_fA_y = str_p_exc_fA_y[-inf,var_scan-1]+str_p_exc_fA_y[var_scan+1,inf]			endif		endif		var_scan+=1	while(var_scan<strlen(str_p_exc_fA_y))	string/g str_np_exc_fA_y=getdimlabel($(str_output+"_m_fA_tuk_np_sig"),1,var_label)	str_np_exc_fA_y = replacestring(str_output,str_np_exc_fA_y,"")	str_np_exc_fA_y = replacestring("w_fA",str_np_exc_fA_y,"")	str_np_exc_fA_y = replacestring("_",str_np_exc_fA_y,"")	str_np_exc_fA_y = replacestring("vs",str_np_exc_fA_y,"_vs_")	variable/g var_scan = 0	do		if(numtype(str2num(str_np_exc_fA_y[var_scan])) != 2)			if(var_scan == 0)				str_np_exc_fA_y = str_np_exc_fA_y[var_scan+1,inf]			else				str_np_exc_fA_y = str_np_exc_fA_y[-inf,var_scan-1]+str_np_exc_fA_y[var_scan+1,inf]			endif		endif		var_scan+=1	while(var_scan<strlen(str_np_exc_fA_y))	$(str_output+"_m_fA_tuk_p_ylbl")[var_label]=str_p_exc_fA_y	$(str_output+"_m_fA_tuk_np_ylbl")[var_label]=str_np_exc_fA_y	var_label+=1while(var_label<dimsize($(str_output+"_m_fA_tuk_p_sig"),1))make/o/t/n=(dimsize($(str_output+"_m_fB_tuk_p_sig"),0)) $(str_output+"_m_fB_tuk_p_xlbl")make/o/n=(dimsize($(str_output+"_m_fB_tuk_p_sig"),0)) $(str_output+"_m_fB_tuk_p_xloc") = xmake/o/t/n=(dimsize($(str_output+"_m_fB_tuk_np_sig"),0)) $(str_output+"_m_fB_tuk_np_xlbl")make/o/n=(dimsize($(str_output+"_m_fB_tuk_np_sig"),0)) $(str_output+"_m_fB_tuk_np_xloc") = xmake/o/t/n=(dimsize($(str_output+"_m_fB_tuk_p_sig"),1)) $(str_output+"_m_fB_tuk_p_ylbl")make/o/n=(dimsize($(str_output+"_m_fB_tuk_p_sig"),1)) $(str_output+"_m_fB_tuk_p_yloc") = xmake/o/t/n=(dimsize($(str_output+"_m_fB_tuk_np_sig"),1)) $(str_output+"_m_fB_tuk_np_ylbl")make/o/n=(dimsize($(str_output+"_m_fB_tuk_np_sig"),1)) $(str_output+"_m_fB_tuk_np_yloc") = xvariable/g var_label = 0do	string/g str_p_exc_fB_x=getdimlabel($(str_output+"_m_fB_tuk_p_sig"),0,var_label)	str_p_exc_fB_x = replacestring(str_output,str_p_exc_fB_x,"")	str_p_exc_fB_x = replacestring("w_fB",str_p_exc_fB_x,"")	str_p_exc_fB_x = replacestring("_",str_p_exc_fB_x,"")	str_p_exc_fB_x = replacestring(str_catch,str_p_exc_fB_x,"")	string/g str_np_exc_fB_x=getdimlabel($(str_output+"_m_fB_tuk_np_sig"),0,var_label)	str_np_exc_fB_x = replacestring(str_output,str_np_exc_fB_x,"")	str_np_exc_fB_x = replacestring("w_fB",str_np_exc_fB_x,"")	str_np_exc_fB_x = replacestring("_",str_np_exc_fB_x,"")	str_np_exc_fB_x = replacestring(str_catch,str_np_exc_fB_x,"")	$(str_output+"_m_fB_tuk_p_xlbl")[var_label]=str_p_exc_fB_x	$(str_output+"_m_fB_tuk_np_xlbl")[var_label]=str_np_exc_fB_x	var_label+=1while(var_label<dimsize($(str_output+"_m_fB_tuk_p_sig"),0))variable/g var_label = 0do	string/g str_p_exc_fB_y=getdimlabel($(str_output+"_m_fB_tuk_p_sig"),1,var_label)	str_p_exc_fB_y = replacestring(str_output,str_p_exc_fB_y,"")	str_p_exc_fB_y = replacestring("m_tuk_p",str_p_exc_fB_y,"")	str_p_exc_fB_y = replacestring("_",str_p_exc_fB_y,"")	str_p_exc_fB_y = replacestring("vs",str_p_exc_fB_y,"_vs_")	variable/g var_scan = 0	do		if(numtype(str2num(str_p_exc_fB_y[var_scan])) != 2)			if(var_scan == 0)				str_p_exc_fB_y = str_p_exc_fB_y[var_scan+1,inf]			else				str_p_exc_fB_y = str_p_exc_fB_y[-inf,var_scan-1]+str_p_exc_fB_y[var_scan+1,inf]			endif		endif		var_scan+=1	while(var_scan<strlen(str_p_exc_fB_y))	string/g str_np_exc_fB_y=getdimlabel($(str_output+"_m_fB_tuk_np_sig"),1,var_label)	str_np_exc_fB_y = replacestring(str_output,str_np_exc_fB_y,"")	str_np_exc_fB_y = replacestring("m_tuk_np",str_np_exc_fB_y,"")	str_np_exc_fB_y = replacestring("_",str_np_exc_fB_y,"")	str_np_exc_fB_y = replacestring("vs",str_np_exc_fB_y,"_vs_")	variable/g var_scan = 0	do		if(numtype(str2num(str_np_exc_fB_y[var_scan])) != 2)			if(var_scan == 0)				str_np_exc_fB_y = str_np_exc_fB_y[var_scan+1,inf]			else				str_np_exc_fB_y = str_np_exc_fB_y[-inf,var_scan-1]+str_p_exc_fB_y[var_scan+1,inf]			endif		endif		var_scan+=1	while(var_scan<strlen(str_p_exc_fB_y))	$(str_output+"_m_fB_tuk_p_ylbl")[var_label]=str_p_exc_fB_y	$(str_output+"_m_fB_tuk_np_ylbl")[var_label]=str_np_exc_fB_y	var_label+=1while(var_label<dimsize($(str_output+"_m_fB_tuk_p_sig"),1))//string/g str_leg_w2A = str_output+"\rFactor A, p = "+num2str($("w2Ap_"+str_output)[%$("Factor A")])+"\rFactor B, p = "+num2str($("w2Ap_"+str_output)[%$("Factor B")])+"\rFactor AxB, p = "+num2str($("w2Ap_"+str_output)[%$("Factor AxB")])string/g str_leg_w2A_fB_p = str_output+", ANOVA, Tukey post hoc\rFactor B, p = "+num2str($("w2Ap_"+str_output)[%$("Factor B")])+", Factor AxB, p = "+num2str($("w2Ap_"+str_output)[%$("Factor AxB")])displaymovewindow 300,45,650,350appendimage $(str_output+"_m_fB_tuk_p_sig")modifyimage $(str_output+"_m_fB_tuk_p_sig") ctab= {0,0.05,CyanMagenta,0}modifygraph userticks(left)={$(str_output+"_m_fB_tuk_p_yloc"),$(str_output+"_m_fB_tuk_p_ylbl")}modifygraph userticks(bottom)={$(str_output+"_m_fB_tuk_p_xloc"),$(str_output+"_m_fB_tuk_p_xlbl")}modifygraph tkLblrot(bottom)=90legend/j/f=0/a=lt/b=1/e=2/x=0/y=0 str_leg_w2A_fB_pvariable/g var_g_x = 0do	variable/g var_g_y = 0	do		if($(str_output+"_m_fB_tuk_p_sig")[var_g_x][var_g_y] < 0.05)			setdrawenv fsize=8,xcoord=bottom,ycoord=left,textxjust=1,textyjust=1			drawtext var_g_x,var_g_y,num2str($(str_output+"_m_fB_tuk_p_sig")[var_g_x][var_g_y])		endif		var_g_y+=1	while(var_g_y<dimsize($(str_output+"_m_fB_tuk_p_sig"),1))	var_g_x+=1while(var_g_x<dimsize($(str_output+"_m_fB_tuk_p_sig"),0))string/g str_leg_w2A_fB_np = str_output+", ANOVA, Nemenyi post hoc\rFactor B, p = "+num2str($("w2Ap_"+str_output)[%$("Factor B")])+", Factor AxB, p = "+num2str($("w2Ap_"+str_output)[%$("Factor AxB")])displaymovewindow 310,65,660,370appendimage $(str_output+"_m_fB_tuk_np_sig")modifyimage $(str_output+"_m_fB_tuk_np_sig") ctab= {0,0.05,CyanMagenta,0}modifygraph userticks(left)={$(str_output+"_m_fB_tuk_np_yloc"),$(str_output+"_m_fB_tuk_np_ylbl")}modifygraph userticks(bottom)={$(str_output+"_m_fB_tuk_np_xloc"),$(str_output+"_m_fB_tuk_np_xlbl")}modifygraph tkLblrot(bottom)=90legend/j/f=0/a=lt/b=1/e=2/x=0/y=0 str_leg_w2A_fB_npvariable/g var_g_x = 0do	variable/g var_g_y = 0	do		if($(str_output+"_m_fB_tuk_np_sig")[var_g_x][var_g_y] < 0.05)			setdrawenv fsize=8,xcoord=bottom,ycoord=left,textxjust=1,textyjust=1			drawtext var_g_x,var_g_y,num2str($(str_output+"_m_fB_tuk_np_sig")[var_g_x][var_g_y])		endif		var_g_y+=1	while(var_g_y<dimsize($(str_output+"_m_fB_tuk_np_sig"),1))	var_g_x+=1while(var_g_x<dimsize($(str_output+"_m_fB_tuk_np_sig"),0))string/g str_leg_w2A_fA_p = str_output+", ANOVA, Tukey post hoc\rFactor A, p = "+num2str($("w2Ap_"+str_output)[%$("Factor A")])+", Factor AxB, p = "+num2str($("w2Ap_"+str_output)[%$("Factor AxB")])displaymovewindow 320,85,670,390appendimage $(str_output+"_m_fA_tuk_p_sig")modifyimage $(str_output+"_m_fA_tuk_p_sig") ctab= {0,0.05,CyanMagenta,0}modifygraph userticks(left)={$(str_output+"_m_fA_tuk_p_yloc"),$(str_output+"_m_fA_tuk_p_ylbl")}modifygraph userticks(bottom)={$(str_output+"_m_fA_tuk_p_xloc"),$(str_output+"_m_fA_tuk_p_xlbl")}legend/j/f=0/a=lt/b=1/e=2/x=0/y=0 str_leg_w2A_fA_pvariable/g var_g_x = 0do	variable/g var_g_y = 0	do		if($(str_output+"_m_fA_tuk_p_sig")[var_g_x][var_g_y] < 0.05)			setdrawenv fsize=8,xcoord=bottom,ycoord=left,textxjust=1,textyjust=1			drawtext var_g_x,var_g_y,num2str($(str_output+"_m_fA_tuk_p_sig")[var_g_x][var_g_y])		endif		var_g_y+=1	while(var_g_y<dimsize($(str_output+"_m_fA_tuk_p_sig"),1))	var_g_x+=1while(var_g_x<dimsize($(str_output+"_m_fA_tuk_p_sig"),0))string/g str_leg_w2A_fA_np = str_output+", ANOVA, Nemenyi post hoc\rFactor A, p = "+num2str($("w2Ap_"+str_output)[%$("Factor A")])+", Factor AxB, p = "+num2str($("w2Ap_"+str_output)[%$("Factor AxB")])displaymovewindow 330,105,680,410appendimage $(str_output+"_m_fA_tuk_np_sig")modifyimage $(str_output+"_m_fA_tuk_np_sig") ctab= {0,0.05,CyanMagenta,0}modifygraph userticks(left)={$(str_output+"_m_fA_tuk_np_yloc"),$(str_output+"_m_fA_tuk_np_ylbl")}modifygraph userticks(bottom)={$(str_output+"_m_fA_tuk_np_xloc"),$(str_output+"_m_fA_tuk_np_xlbl")}legend/j/f=0/a=lt/b=1/e=2/x=0/y=0 str_leg_w2A_fA_npvariable/g var_g_x = 0do	variable/g var_g_y = 0	do		if($(str_output+"_m_fA_tuk_np_sig")[var_g_x][var_g_y] < 0.05)			setdrawenv fsize=8,xcoord=bottom,ycoord=left,textxjust=1,textyjust=1			drawtext var_g_x,var_g_y,num2str($(str_output+"_m_fA_tuk_np_sig")[var_g_x][var_g_y])		endif		var_g_y+=1	while(var_g_y<dimsize($(str_output+"_m_fA_tuk_np_sig"),1))	var_g_x+=1while(var_g_x<dimsize($(str_output+"_m_fA_tuk_np_sig"),0))//edit $(str_output+"_m_fB_tuk_p_xlbl"),$(str_output+"_m_fB_tuk_p_ylbl"),$(str_output+"_m_fB_tuk_np_xlbl"),$(str_output+"_m_fB_tuk_np_ylbl")//edit $(str_output+"_m_fA_tuk_p_xlbl"),$(str_output+"_m_fA_tuk_p_ylbl"),$(str_output+"_m_fA_tuk_np_xlbl"),$(str_output+"_m_fA_tuk_np_ylbl")edit $(str_output+"_groups")resumeupdateend