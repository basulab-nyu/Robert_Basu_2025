#pragma rtGlobals=1macro plot_stats_1D_samples_batch()pplot_stats_1D_samples_batch()proc pplot_stats_1D_samples_batch(str_groups_batch,str_group_size)string str_groups_batchprompt str_groups_batch "groups textwave ?"string str_group_sizeprompt str_group_size "groups size ?"if(strlen(str_groups_batch) == 0)	str_groups_batch = "w_input"endifif(strlen(str_group_size) == 0)	str_group_size = "5"endifstring str_inputstring str_liststring str_catchstring str_labelstring str_label_xstring str_label_ystring str_outputstring str_batchstring str_summvariable var_indexvariable var_index1variable var_index2variable var_pairvariable var_loop = 0pauseupdatedostr_input = ""str_input = $str_groups_batch[var_loop]str_list = ""str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")str_catch = ""str_catch = str_input[strsearch(str_input,"*",0)+1,inf]str_output = ""if(stringmatch(str_catch[0],"_") == 1)	str_output = "stats"+str_catchelse	str_output = "stats_"+str_catchendifstr_batch = addlistitem(str_output,str_batch,";",inf)make/o/n=(12,itemsinlist(str_list)) $str_output = nansetdimlabel 0,0,avg,$str_outputsetdimlabel 0,1,sem,$str_outputsetdimlabel 0,2,n_nonNaN,$str_outputsetdimlabel 0,3,n_total,$str_outputsetdimlabel 0,4,shapiro_wilk,$str_outputsetdimlabel 0,5,jarque_bera,$str_outputsetdimlabel 0,6,homoscedasticity,$str_outputsetdimlabel 0,7,anova1,$str_outputsetdimlabel 0,8,kruskall_wallis_chi,$str_outputsetdimlabel 0,9,kruskall_wallis_wallace,$str_outputsetdimlabel 0,10,anova2rm,$str_outputsetdimlabel 0,11,friedman,$str_outputvar_pair = 1var_index = 0do	str_label = ""	str_label = stringfromlist(var_index,str_list)	str_label = replacestring(str_catch,str_label,"")	setdimlabel 1,var_index,$str_label,$str_output	wavestats/q $stringfromlist(var_index,str_list)	$str_output[0][var_index] = v_avg	$str_output[1][var_index] = v_sem	$str_output[2][var_index] = v_npnts	$str_output[3][var_index] = v_npnts+v_numnans+v_numinfs	killvariables/z v_prob	statsshapirowilktest/q/z $stringfromlist(var_index,str_list)	if(v_prob < 0.05)		$str_output[4][var_index] = 0	else		$str_output[4][var_index] = 1	endif	killwaves/z W_JBResults	statsjbtest/q/z $stringfromlist(var_index,str_list)	if(w_jbresults[%JBStatistic] >= w_jbresults[%Critical])		$str_output[5][var_index] = 0	else		$str_output[5][var_index] = 1	endif	if($str_output[2][0] != $str_output[2][var_index])		var_pair = 0	endif	var_index+=1while(var_index<itemsinlist(str_list))killwaves/z w_statsvariancesteststatsvariancestest/q/z/wstr=str_listif(w_statsvariancestest[%Bartlett_T] >= w_statsvariancestest[%Critical])	$str_output[6][0] = 0else	$str_output[6][0] = 1endifkillwaves/z m_anova1statsanova1test/q/z/wstr=str_list$str_output[7][0] = m_anova1[%Total][%P]killwaves/z w_kwtestresultsstatskwtest/q/z/wstr=str_list$str_output[8][0] = w_kwtestresults[%P_Chi_square_approx]$str_output[9][0] = w_kwtestresults[%P_Wallace_approx]if(var_pair == 1)	killwaves/z m_anova2rmresults	make/o/n=($str_output[2][0],itemsinlist(str_list)) temp2D = nan	var_index = 0	do		temp2D[][var_index] = $stringfromlist(var_index,str_list)[p]		var_index+=1	while(var_index<itemsinlist(str_list))	statsanova2rmtest/q/z temp2D	$str_output[10][0] = 1-statsfcdf(m_anova2rmresults[%Test_H0][%F],m_anova2rmresults[%Groups][%DF],m_anova2rmresults[%Remainder][%DF])	killwaves/z temp2D	killwaves/z m_friedmantestresults	statsfriedmantest/q/z/wstr=str_list	$str_output[11][0] = 1-statsfriedmancdf(m_friedmantestresults[0][%Statistic],m_friedmantestresults[0][%Columns],m_friedmantestresults[0][%Rows],1,1)endifkillwaves/z m_tukeytestresults,t_tukeydescriptorsstatstukeytest/q/z/swn/wstr=str_listredimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output$str_output[dimsize($str_output,0)-1][] = nansetdimlabel 0,dimsize($str_output,0)-1,tukey,$str_outputmake/o/n=(itemsinlist(str_list),itemsinlist(str_list)) $(str_output+"_tuk_pvalue_matrix") = nanvar_index = 0do	str_label = ""	str_label = stringfromlist(var_index,str_list)	str_label = replacestring(str_catch,str_label,"")	setdimlabel 0,var_index,$str_label,$(str_output+"_tuk_pvalue_matrix")	setdimlabel 1,var_index,$str_label,$(str_output+"_tuk_pvalue_matrix")	var_index+=1while(var_index<itemsinlist(str_list))var_index = 0do	redimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output	$str_output[dimsize($str_output,0)-1][] = nan	$str_output[dimsize($str_output,0)-1][0] = m_tukeytestresults[var_index][%P]	str_label = ""	str_label = t_tukeydescriptors[var_index]	str_label = replacestring(str_catch,str_label,"")	setdimlabel 0,dimsize($str_output,0)-1,$str_label,$str_output	str_label_x = str_label[0,strsearch(str_label," vs ",0)-1]	str_label_y = str_label[strsearch(str_label," vs ",0)+strlen(" vs "),inf]	if(finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_x) < finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_y))		$(str_output+"_tuk_pvalue_matrix")[finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_x)][finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_y)] = $str_output[dimsize($str_output,0)-1][0]	else		$(str_output+"_tuk_pvalue_matrix")[finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_y)][finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_x)] = $str_output[dimsize($str_output,0)-1][0]	endif	var_index+=1while(var_index<dimsize(m_tukeytestresults,0))killwaves/z m_npmctukeyresults,t_npmctukeydescriptors,m_npmcdhwresults,t_npmcdhwdescriptorsstatsnpmctest/q/z/tuk/dhw/swn/wstr=str_listredimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output$str_output[dimsize($str_output,0)-1][] = nansetdimlabel 0,dimsize($str_output,0)-1,nemenyi,$str_outputmake/o/n=(itemsinlist(str_list),itemsinlist(str_list)) $(str_output+"_nmy_pvalue_matrix") = nanvar_index = 0do	str_label = ""	str_label = stringfromlist(var_index,str_list)	str_label = replacestring(str_catch,str_label,"")	setdimlabel 0,var_index,$str_label,$(str_output+"_nmy_pvalue_matrix")	setdimlabel 1,var_index,$str_label,$(str_output+"_nmy_pvalue_matrix")	var_index+=1while(var_index<itemsinlist(str_list))if(v_flag != 1)	var_index = 0	do		redimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output		$str_output[dimsize($str_output,0)-1][] = nan		$str_output[dimsize($str_output,0)-1][0] = 1-statsqcdf(m_npmctukeyresults[var_index][%q],1,itemsinlist(str_list),itemsinlist(str_list)*($str_output[2][0]-1))		str_label = ""		str_label = t_npmctukeydescriptors[var_index]		str_label = replacestring(str_catch,str_label,"")		setdimlabel 0,dimsize($str_output,0)-1,$str_label,$str_output		str_label_x = str_label[0,strsearch(str_label,"_vs_",0)-1]		str_label_y = str_label[strsearch(str_label,"_vs_",0)+strlen("_vs_"),inf]		if(finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_x) < finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_y))			$(str_output+"_nmy_pvalue_matrix")[finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_x)][finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_y)] = $str_output[dimsize($str_output,0)-1][0]		else			$(str_output+"_nmy_pvalue_matrix")[finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_y)][finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_x)] = $str_output[dimsize($str_output,0)-1][0]		endif		var_index+=1	while(var_index<dimsize(m_npmctukeyresults,0))endifredimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output$str_output[dimsize($str_output,0)-1][] = nansetdimlabel 0,dimsize($str_output,0)-1,dunn_holland_wolfe,$str_outputmake/o/n=(itemsinlist(str_list),itemsinlist(str_list)) $(str_output+"_dhw_pvalue_matrix") = nanvar_index = 0do	str_label = ""	str_label = stringfromlist(var_index,str_list)	str_label = replacestring(str_catch,str_label,"")	setdimlabel 0,var_index,$str_label,$(str_output+"_dhw_pvalue_matrix")	setdimlabel 1,var_index,$str_label,$(str_output+"_dhw_pvalue_matrix")	var_index+=1while(var_index<itemsinlist(str_list))var_index = 0do	redimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output	$str_output[dimsize($str_output,0)-1][] = nan	$str_output[dimsize($str_output,0)-1][0] = 1-statsqcdf(m_npmcdhwresults[var_index][%q],1,itemsinlist(str_list),itemsinlist(str_list)*($str_output[2][0]-1))	str_label = ""	str_label = t_npmcdhwdescriptors[var_index]	str_label = replacestring(str_catch,str_label,"")	setdimlabel 0,dimsize($str_output,0)-1,$str_label,$str_output	str_label_x = str_label[0,strsearch(str_label,"_vs_",0)-1]	str_label_y = str_label[strsearch(str_label,"_vs_",0)+strlen("_vs_"),inf]	if(finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_x) < finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_y))		$(str_output+"_dhw_pvalue_matrix")[finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_x)][finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_y)] = $str_output[dimsize($str_output,0)-1][0]	else		$(str_output+"_dhw_pvalue_matrix")[finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_y)][finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_x)] = $str_output[dimsize($str_output,0)-1][0]	endif	var_index+=1while(var_index<dimsize(m_npmcdhwresults,0))//edit $str_output.ld//movewindow 0,45,350,350killwaves/z W_JBResultskillwaves/z w_statsvariancestestkillwaves/z m_anova1killwaves/z w_kwtestresultskillwaves/z m_anova2rmresultskillwaves/z m_friedmantestresultskillwaves/z m_tukeytestresults,t_tukeydescriptorskillwaves/z m_npmctukeyresults,t_npmctukeydescriptors,m_npmcdhwresults,t_npmcdhwdescriptorsvar_loop+=1while(var_loop<numpnts($str_groups_batch))var_loop = 0do	str_summ = stringfromlist(var_loop,str_batch)[0,strlen(stringfromlist(var_loop,str_batch))-3]	make/n=(str2num(str_group_size)) $(str_summ+"_anova1") = nan	var_index = 0	do		make/n=(str2num(str_group_size)) $(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_avg") = nan		make/n=(str2num(str_group_size)) $(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_sem") = nan		var_index+=1	while(var_index<dimsize($stringfromlist(var_loop,str_batch),1))	var_index = var_loop	var_index1 = 0	do		$(str_summ+"_anova1")[var_index1] = $stringfromlist(var_index,str_batch)[7]		setdimlabel 0,var_index1,$stringfromlist(var_index,str_batch),$(str_summ+"_anova1")		var_index2 = 0		do			$(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index2)+"_avg")[var_index1] = $stringfromlist(var_index,str_batch)[0][var_index2]			$(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index2)+"_sem")[var_index1] = $stringfromlist(var_index,str_batch)[1][var_index2]			setdimlabel 0,var_index1,$stringfromlist(var_index,str_batch),$(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index2)+"_avg")			setdimlabel 0,var_index1,$stringfromlist(var_index,str_batch),$(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index2)+"_sem")			var_index2+=1		while(var_index2<dimsize($stringfromlist(var_index,str_batch),1))		var_index+=1		var_index1+=1	while(var_index<var_loop+str2num(str_group_size))	display	movewindow 400,45,750,350	var_index = 0	do		appendtograph $(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_avg")		if(stringmatch(getdimlabel($stringfromlist(var_loop,str_batch),1,var_index),"control") == 1)			modifygraph rgb($(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_avg")) = (0,0,0)		endif		if(stringmatch(getdimlabel($stringfromlist(var_loop,str_batch),1,var_index),"LECglu") == 1)			modifygraph rgb($(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_avg")) = (2,39321,1)		endif		if(stringmatch(getdimlabel($stringfromlist(var_loop,str_batch),1,var_index),"LECgaba") == 1)			modifygraph rgb($(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_avg")) = (65535,0,0)		endif		errorbars $(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_avg") SHADE= {0,4,(0,0,0,0),(0,0,0,0)},wave=($(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_sem"),$(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_sem"))		modifygraph mode($(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_avg")) = 0		modifygraph lsize($(str_summ+"_"+getdimlabel($stringfromlist(var_loop,str_batch),1,var_index)+"_avg")) = 2		var_index+=1	while(var_index<dimsize($stringfromlist(var_loop,str_batch),1))	var_index = 0	do		if($(str_summ+"_anova1")[var_index] < 0.001)			setdrawenv xcoord= bottom,textxjust= 1,textyjust= 1,fstyle= 1,fsize= 20			drawtext var_index+1,0,"***"		else			if($(str_summ+"_anova1")[var_index] < 0.01)				setdrawenv xcoord= bottom,textxjust= 1,textyjust= 1,fstyle= 1,fsize= 20				drawtext var_index+1,0,"**"			else				if($(str_summ+"_anova1")[var_index] < 0.05)					setdrawenv xcoord= bottom,textxjust= 1,textyjust= 1,fstyle= 1,fsize= 20					drawtext var_index+1,0,"*"				endif			endif		endif		var_index+=1	while(var_index<numpnts($(str_summ+"_anova1")))	modifygraph offset={1,0},gfrelsize=4	label left str_summ	label bottom "days"	var_loop+=str2num(str_group_size)while(var_loop<itemsinlist(str_batch))resumeupdateend