#pragma rtGlobals=1Macro Plot_Data()pPD()proc pPD(str_input,str_binO,str_binS,str_binN,str_pairs,str_spread)string str_inputprompt str_input "input waves ?"string str_binOprompt str_binO "start bin ?"string str_binSprompt str_binS "bin size ?"string str_binNprompt str_binN "number of bins ?"string str_pairsprompt str_pairs "paired data (no=0/yes=1) ?"string str_spreadprompt str_spread "spreading factor ?"string str_list = sortlist(wavelist(str_input,";",""),";",16)string str_list_print = sortlist(wavelist(str_input,"\r",""),"\r",16)print str_list_printvariable/g var_binO = str2num(str_binO)variable/g var_binS = str2num(str_binS)variable/g var_binN = str2num(str_binN)variable/g var_spread = 1/str2num(str_spread)string/g str_graph_list = sortlist(winlist("*",";","WIN:1"),";",16)string/g str_table_list = sortlist(winlist("*",";","WIN:2"),";",16)variable/g var_graph_last = itemsinlist(str_graph_list)-1string/g str_graph_last = winname(0,1)variable/g var_table_last = itemsinlist(str_table_list)-1string/g str_table_last = winname(0,2)getwindow $str_graph_last, wsizevariable/g var_left_g = v_left + 5.25variable/g var_top_g = v_top + 22.5variable/g var_right_g = v_right + 5.25variable/g var_bottom_g = v_bottom + 22.5getwindow $str_table_last, wsizevariable/g var_left_t = v_left + 5.25variable/g var_top_t = v_top + 22.5variable/g var_right_t = v_right + 5.25variable/g var_bottom_t = v_bottom + 22.5variable/g var_spacing = 0variable/g var_pairs = str2num(str_pairs)make/o/t/n=(itemsinlist(str_list)) $("w_x_labels_"+stringfromlist(0,str_list))make/o/n=(itemsinlist(str_list)) $("w_x_pos_"+stringfromlist(0,str_list)) = x+0.5*var_spreadvariable/g var_index = 0if (var_pairs == 1)	make/o/n=(numpnts($stringfromlist(0,str_list)),itemsinlist(str_list)) $(nameofwave($stringfromlist(0,str_list))+"_p")else	make/o/n=(itemsinlist(str_list))/t $("w_n_"+stringfromlist(0,str_list))endifdisplaydo	silent 1pauseupdate	if	(var_pairs == 0)		string/g str_waves = stringfromlist(var_index,str_list)		$("w_x_labels_"+stringfromlist(0,str_list))[var_index] = str_waves		duplicate/o $str_waves $(nameofwave($str_waves)+"_D")		sort/diml $(nameofwave($str_waves)+"_D"), $(nameofwave($str_waves)+"_D")		make/o/n=(var_binN) $(nameofwave($str_waves)+"_H")		histogram/p/c/b={var_binO,var_binS,var_binN} $(nameofwave($str_waves)+"_D"), $(nameofwave($str_waves)+"_H")		wavestats/q $(nameofwave($str_waves)+"_H")		var_spacing = var_spacing + V_max		appendtograph/t/vert $(nameofwave($str_waves)+"_H")		modifygraph mode($(nameofwave($str_waves)+"_H"))=7,hbfill($(nameofwave($str_waves)+"_H"))=5		appendboxplot $(nameofwave($str_waves)+"_D")		modifyboxplot trace=$(nameofwave($str_waves)+"_D"),markers={19,19,19},jitter=var_spread,notched,markerSizes={2,2,2},boxwidth=20		wavestats/q $(nameofwave($str_waves)+"_D")		make/o/n=1 $(nameofwave($str_waves)+"_avg") = V_avg		make/o/n=1 $(nameofwave($str_waves)+"_sem") = V_sem		$("w_n_"+stringfromlist(0,str_list))[var_index] = num2str(v_npnts)		appendtograph $(nameofwave($str_waves)+"_avg")		errorbars $(nameofwave($str_waves)+"_avg") Y,wave=($(nameofwave($str_waves)+"_sem"),$(nameofwave($str_waves)+"_sem"))		modify mode($(nameofwave($str_waves)+"_avg"))=3,marker($(nameofwave($str_waves)+"_avg"))=9,msize($(nameofwave($str_waves)+"_avg"))=(20*var_spread),mrkThick($(nameofwave($str_waves)+"_avg"))=3		modifyGraph offset($(nameofwave($str_waves)+"_D"))={var_index+0.5*var_spread,0},offset($(nameofwave($str_waves)+"_avg"))={var_index+0.5*var_spread,0},offset($(nameofwave($str_waves)+"_H"))={0,var_spacing}		if(grepstring(str_waves,"_Le_") == 1)			modifygraph rgb($(nameofwave($str_waves)+"_D")) = (2,39321,1,32768)			modifygraph rgb($(nameofwave($str_waves)+"_H")) = (2,39321,1,32768)			modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (2,39321,1)			if(grepstring(str_waves,"_L_") == 1)				modifygraph rgb($(nameofwave($str_waves)+"_D")) = (1,52428,26586,32768)				modifygraph rgb($(nameofwave($str_waves)+"_H")) = (1,52428,26586,32768)				modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (1,52428,26586)			endif		endif		if(grepstring(str_waves,"_SM_") == 1)			modifygraph rgb($(nameofwave($str_waves)+"_D")) = (34952,34952,34952,32768)			modifygraph rgb($(nameofwave($str_waves)+"_H")) = (34952,34952,34952,32768)			modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (34952,34952,34952)		endif		if(grepstring(str_waves,"_MF_") == 1)			modifygraph rgb($(nameofwave($str_waves)+"_D")) = (39321,13101,1,32768)			modifygraph rgb($(nameofwave($str_waves)+"_H")) = (39321,13101,1,32768)			modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (39321,13101,1)		endif		if(grepstring(str_waves,"_RC_") == 1)			modifygraph rgb($(nameofwave($str_waves)+"_D")) = (0,0,0,32768)			modifygraph rgb($(nameofwave($str_waves)+"_H")) = (0,0,0,32768)			modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (0,0,0)		endif	else		string/g str_waves = stringfromlist(var_index,str_list)		$("w_x_labels_"+stringfromlist(0,str_list))[var_index] = str_waves		duplicate/o $str_waves $(nameofwave($str_waves)+"_D")		sort/diml $(nameofwave($str_waves)+"_D"), $(nameofwave($str_waves)+"_D")		make/o/n=(var_binN) $(nameofwave($str_waves)+"_H")		histogram/p/c/b={var_binO,var_binS,var_binN} $(nameofwave($str_waves)+"_D"), $(nameofwave($str_waves)+"_H")		wavestats/q $(nameofwave($str_waves)+"_H")		appendtograph/t/vert $(nameofwave($str_waves)+"_H")		modifygraph mode($(nameofwave($str_waves)+"_H"))=7,hbfill($(nameofwave($str_waves)+"_H"))=5		wavestats/q $(nameofwave($str_waves)+"_D")		make/o/n=1 $(nameofwave($str_waves)+"_avg") = V_avg		make/o/n=1 $(nameofwave($str_waves)+"_sem") = V_sem		if(var_index == 0)			variable/g var_n = v_npnts		else			var_n = max(var_n,v_npnts)		endif		appendtograph $(nameofwave($str_waves)+"_avg")		errorbars $(nameofwave($str_waves)+"_avg") Y,wave=($(nameofwave($str_waves)+"_sem"),$(nameofwave($str_waves)+"_sem"))		modify mode($(nameofwave($str_waves)+"_avg"))=3,marker($(nameofwave($str_waves)+"_avg"))=9,msize($(nameofwave($str_waves)+"_avg"))=(20*var_spread),mrkThick($(nameofwave($str_waves)+"_avg"))=3		modifyGraph offset($(nameofwave($str_waves)+"_avg"))={var_index+0.5*var_spread,0},offset($(nameofwave($str_waves)+"_H"))={0,var_spacing}		$(nameofwave($stringfromlist(0,str_list))+"_p")[][var_index] = $str_waves[p]		if(grepstring(str_waves,"_Le_") == 1)			modifygraph rgb($(nameofwave($str_waves)+"_H")) = (2,39321,1,32768)			modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (2,39321,1)			if(grepstring(str_waves,"_L_") == 1)				modifygraph rgb($(nameofwave($str_waves)+"_H")) = (1,52428,26586,32768)				modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (1,52428,26586)			endif		endif		if(grepstring(str_waves,"_SM_") == 1)			modifygraph rgb($(nameofwave($str_waves)+"_H")) = (34952,34952,34952,32768)			modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (34952,34952,34952)		endif		if(grepstring(str_waves,"_MF_") == 1)			modifygraph rgb($(nameofwave($str_waves)+"_H")) = (39321,13101,1,32768)			modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (39321,13101,1)		endif		if(grepstring(str_waves,"_RC_") == 1)			modifygraph rgb($(nameofwave($str_waves)+"_H")) = (0,0,0,32768)			modifygraph rgb($(nameofwave($str_waves)+"_avg")) = (0,0,0)		endif	endif	var_index += 1while(var_index<itemsinlist(str_list))if (var_pairs == 1)	string/g str_pivot = stringfromlist(0,tracenamelist("",";",1))	string/g str_reorder	variable/g var_pair_plot = 0	do		appendtograph $(nameofwave($stringfromlist(0,str_list))+"_p")[var_pair_plot][]		if (var_pair_plot == 0)			modifygraph offset($(nameofwave($stringfromlist(0,str_list))+"_p"))={0.5*var_spread,0}			modifygraph rgb($(nameofwave($stringfromlist(0,str_list))+"_p"))=(34952,34952,34952,32768)			reordertraces $str_pivot,{$(nameofwave($stringfromlist(0,str_list))+"_p")}		else			modifygraph offset($(nameofwave($stringfromlist(0,str_list))+"_p#"+num2str(var_pair_plot)))={0.5*var_spread,0}			modifygraph rgb($(nameofwave($stringfromlist(0,str_list))+"_p#"+num2str(var_pair_plot)))=(34952,34952,34952,32768)			reordertraces $str_pivot,{$(nameofwave($stringfromlist(0,str_list))+"_p#"+num2str(var_pair_plot))}		endif		var_pair_plot+=1	while (var_pair_plot < dimsize($(nameofwave($stringfromlist(0,str_list))+"_p"),0))endifmodifygraph axRGB(top)=(65535,65535,65535),tlblRGB(top)=(65535,65535,65535),alblRGB(top)=(65535,65535,65535)setaxis bottom 0,var_index+0.5*var_spreadmodifygraph axisenab(bottom)={0,0.5},axisenab(top)={0.5,1}modifygraph userticks(bottom)={$("w_x_pos_"+stringfromlist(0,str_list)),$("w_x_labels_"+stringfromlist(0,str_list))}modifygraph tkLblRot(bottom)=45modifygraph gfrelsize = 4variable/g var_relabel = 0do	if(grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_Le_") == 1 && grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_H_") == 1)		$("w_x_labels_"+stringfromlist(0,str_list))[var_relabel] = "LREP high"	endif	if(grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_Le_") == 1 && grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_L_") == 1)		$("w_x_labels_"+stringfromlist(0,str_list))[var_relabel] = "LREP low"	endif	if(grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_Le_") == 1 && grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_H_") == 0 && grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_L_") == 0)		$("w_x_labels_"+stringfromlist(0,str_list))[var_relabel] = "LREP"	endif	if(grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_Li_") == 1)		$("w_x_labels_"+stringfromlist(0,str_list))[var_relabel] = "LRIP"	endif	if(grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_MF_") == 1)		$("w_x_labels_"+stringfromlist(0,str_list))[var_relabel] = "MF"	endif	if(grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_RC_") == 1)		$("w_x_labels_"+stringfromlist(0,str_list))[var_relabel] = "RC"	endif	if(grepstring($("w_x_labels_"+stringfromlist(0,str_list))[var_relabel],"_SM_") == 1)		$("w_x_labels_"+stringfromlist(0,str_list))[var_relabel] = "SM"	endif	var_relabel+=1while(var_relabel<numpnts($("w_x_labels_"+stringfromlist(0,str_list))))if(grepstring(nameofwave($("w_x_labels_"+stringfromlist(0,str_list))),"EPSC") == 1 && grepstring(nameofwave($("w_x_labels_"+stringfromlist(0,str_list))),"amp") == 1)	label left "EPSC amplitude (pA)"endifif(grepstring(nameofwave($("w_x_labels_"+stringfromlist(0,str_list))),"IPSC") == 1 && grepstring(nameofwave($("w_x_labels_"+stringfromlist(0,str_list))),"amp") == 1)	label left "IPSC amplitude (pA)"endifif(grepstring(nameofwave($("w_x_labels_"+stringfromlist(0,str_list))),"PSP") == 1 && grepstring(nameofwave($("w_x_labels_"+stringfromlist(0,str_list))),"amp") == 1)	label left "PSP amplitude (mV)"endifsetdrawenv textxjust=1,textyjust=1,fstyle=1drawtext 0.2,-0.2,"title"if(var_pairs == 1)	setdrawenv textxjust=1,textyjust=1	drawtext 0.2,1.25,"(n = "+num2str(var_n)+")"else	variable/g var_setN = 0	do		$("w_x_labels_"+stringfromlist(0,str_list))[var_setN] = $("w_x_labels_"+stringfromlist(0,str_list))[var_setN]+" (n = "+$("w_n_"+stringfromlist(0,str_list))[var_setN]+")"		var_setN+=1	while(var_setN<numpnts($("w_n_"+stringfromlist(0,str_list))))endifmovewindow var_left_g,var_top_g,var_right_g,var_bottom_gshowtools/a arrowresumeupdateedit $("w_x_labels_"+stringfromlist(0,str_list))end