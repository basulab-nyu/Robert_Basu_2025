#pragma rtGlobals=1macro ANOVA2_2D_waves()pANOVA2_2D_waves()proc pANOVA2_2D_waves(str_input,str_output)string str_inputprompt str_input "input waves ?"string str_outputprompt str_output "output waves ?"string str_listvariable var_indexstr_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")silent 1pauseupdatevar_index = 0make/o/n=(dimsize($stringfromlist(var_index,str_list),0),itemsinlist(str_list),dimsize($stringfromlist(var_index,str_list),1)) $(str_output+"_3D") = nando	$(str_output+"_3D")[][var_index][] = $stringfromlist(var_index,str_list)[p][r]	var_index+=1while(var_index<itemsinlist(str_list))killwaves/z m_anova2resultsstatsanova2test/modl=1 $(str_output+"_3D")make/o/n=3 $(str_output+"_3D_anova") = nan$(str_output+"_3D_anova")[0] = 1-statsfcdf(m_anova2results[%Factor_A][%F],m_anova2results[%Factor_A][%DF],m_anova2results[%Error_within_cells][%DF])$(str_output+"_3D_anova")[1] = 1-statsfcdf(m_anova2results[%Factor_B][%F],m_anova2results[%Factor_B][%DF],m_anova2results[%Error_within_cells][%DF])$(str_output+"_3D_anova")[2] = 1-statsfcdf(m_anova2results[%A_x_B][%F],m_anova2results[%A_x_B][%DF],m_anova2results[%Error_within_cells][%DF])setdimlabel 0,0,factor_A_p_value,$(str_output+"_3D_anova")setdimlabel 0,1,factor_B_p_value,$(str_output+"_3D_anova")setdimlabel 0,2,factor_AxB_p_value,$(str_output+"_3D_anova")edit $(str_output+"_3D_anova").ldkillwaves/z m_anova2resultsresumeupdateend