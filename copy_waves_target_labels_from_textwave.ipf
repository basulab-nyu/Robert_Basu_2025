#pragma rtGlobals=1Macro copy_waves_target_labels_from_textwave()pcopy_waves_target_labels_from_textwave()proc pcopy_waves_target_labels_from_textwave(str_input,str_ref,str_dim,str_output)string str_inputprompt str_input "input waves ?"string str_refprompt str_ref "reference textwave ?"string str_dimprompt str_dim "label dimension ?"string str_outputprompt str_output "output waves ?"string/g str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")if(strlen(str_dim) == 0)	variable/g var_dim = 0else	variable/g var_dim = str2num(str_dim)endifsilent 1pauseupdateif(strlen(str_list)>0)	variable/g var_index = 0	do		make/o/n=0 $(stringfromlist(var_index,str_list)+"_"+str_output)		variable/g var_labels = 0		do			variable/g var_check = 0			do				if (exists("str_grep") == 2)					killstrings/z str_grep				endif				string/g str_grep = $str_ref[var_check]				if(grepstring(getdimlabel($stringfromlist(var_index,str_list),var_dim,var_labels),str_grep) == 1)					if(var_dim == 0)						if(dimsize($stringfromlist(var_index,str_list),1) == 0)							redimension/n=(dimsize($(stringfromlist(var_index,str_list)+"_"+str_output),var_dim)+1) $(stringfromlist(var_index,str_list)+"_"+str_output)							$(stringfromlist(var_index,str_list)+"_"+str_output)[dimsize($(stringfromlist(var_index,str_list)+"_"+str_output),var_dim)-1] = $stringfromlist(var_index,str_list)[var_labels]						else							redimension/n=(dimsize($(stringfromlist(var_index,str_list)+"_"+str_output),0)+1,dimsize($stringfromlist(var_index,str_list),1)) $(stringfromlist(var_index,str_list)+"_"+str_output)							$(stringfromlist(var_index,str_list)+"_"+str_output)[dimsize($(stringfromlist(var_index,str_list)+"_"+str_output),0)-1][] = $stringfromlist(var_index,str_list)[var_labels][q]						endif					endif					if(var_dim == 1)						redimension/n=(dimsize($stringfromlist(var_index,str_list),0),dimsize($(stringfromlist(var_index,str_list)+"_"+str_output),var_dim)+1) $(stringfromlist(var_index,str_list)+"_"+str_output)						$(stringfromlist(var_index,str_list)+"_"+str_output)[][dimsize($(stringfromlist(var_index,str_list)+"_"+str_output),var_dim)-1] = $stringfromlist(var_index,str_list)[p][var_labels]					endif					setdimlabel var_dim,dimsize($(stringfromlist(var_index,str_list)+"_"+str_output),var_dim)-1,$getdimlabel($stringfromlist(var_index,str_list),var_dim,var_labels),$(stringfromlist(var_index,str_list)+"_"+str_output)				endif				var_check+=1			while(var_check<numpnts($str_ref))			var_labels+=1		while(var_labels<dimsize($stringfromlist(var_index,str_list),var_dim))		var_index+=1	while(var_index<itemsinlist(str_list))endifresumeupdateend