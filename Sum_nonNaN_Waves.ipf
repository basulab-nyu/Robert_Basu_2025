#pragma rtGlobals=1Macro Sum_nonNaN_Waves()pSum_nonNaN_Waves()proc pSum_nonNaN_Waves(str_input1,str_input2,str_output)string str_input1prompt str_input1 "input waves 1 ?"string str_input2prompt str_input2 "input waves 2 ?"string str_outputprompt str_output "output waves ?"string/g str_list1 = sortlist(wavelist(str_input1,";",""),";",16)print sortlist(wavelist(str_input1,"\r",""),"\r",16)string/g str_list2 = sortlist(wavelist(str_input2,";",""),";",16)print sortlist(wavelist(str_input2,"\r",""),"\r",16)silent 1pauseupdatevariable/g var_index = 0do	string/g str_name = stringfromlist(var_index,str_list1)+"_p_"+stringfromlist(var_index,str_list2)+"_"+str_output	duplicate/o $stringfromlist(var_index,str_list1) $str_name	duplicate/o $stringfromlist(var_index,str_list1) temp1	duplicate/o $stringfromlist(var_index,str_list2) temp2	$str_name = nan	$str_name = temp1+temp2	killwaves/z temp1,temp2	wavestats/q $stringfromlist(var_index,str_list1)	variable/g var_nan1 = V_numNaNs	wavestats/q $stringfromlist(var_index,str_list2)	variable/g var_nan2 = V_numNaNs	if(var_nan1 != 0 || var_nan2 != 0)		variable/g var_scroll = 0		do			if(numtype($stringfromlist(var_index,str_list1)[var_scroll]) == 2 || numtype($stringfromlist(var_index,str_list2)[var_scroll]) == 2)				$str_name[var_scroll] = nan			endif			var_scroll+=1		while(var_scroll<numpnts($str_name))	endif	var_index+=1while(var_index<itemsinlist(str_list1))resumeupdateend