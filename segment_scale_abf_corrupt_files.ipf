#pragma rtGlobals=1Macro segment_scale_abf_corrupt_files()psegment_scale_abf_corrupt_files()proc psegment_scale_abf_corrupt_files(str_input,str_header,str_sweep,str_scale)string str_inputprompt str_input "input waves ?"string str_headerprompt str_header "header length ?"string str_sweepprompt str_sweep "sweep length ?"string str_scaleprompt str_scale "scaling factor ?"if(strlen(str_scale) == 0)	str_scale = "1"endifstring str_listvariable var_indexvariable var_index2str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")var_index = 0do	duplicate/o/r=[str2num(str_header),inf] $stringfromlist(var_index,str_list) tempwave	tempwave = tempwave*str2num(str_scale)	var_index2 = 0	do		duplicate/o/r=[var_index2*str2num(str_sweep),(var_index2+1)*str2num(str_sweep)] tempwave $(stringfromlist(var_index,str_list)+"_"+num2str(var_index2))		setscale/p x,dimoffset($stringfromlist(var_index,str_list),0),dimdelta($stringfromlist(var_index,str_list),0),$(stringfromlist(var_index,str_list)+"_"+num2str(var_index2))		var_index2+=1	while(var_index2<numpnts(tempwave)/str2num(str_sweep))	var_index+=1while(var_index<itemsinlist(str_list))killwaves/z tempwaveend