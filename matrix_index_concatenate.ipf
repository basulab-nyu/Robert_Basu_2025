#pragma rtGlobals=1		// Use modern global access method.#include <Waves Average>macro matrix_index_concatenate()pmatrix_index_concatenate()proc pmatrix_index_concatenate(str_input,str_sort,str_output)string str_inputprompt str_input "input waves (textref) ?"string str_sortprompt str_sort "sorting waves (textref) ?"string str_outputprompt str_output "output waves ?"string str_liststring str_idxliststring str_namestring str_name2variable var_refvariable var_indexvariable var_startvariable var_stopvariable var_start2variable var_stop2var_ref = 0do	str_list = ""	str_list = sortlist(wavelist($str_input[var_ref],";",""),";",16)	str_idxlist = ""	str_idxlist = sortlist(wavelist($str_sort[var_ref],";",""),";",16)	str_name = $str_input[var_ref]	str_name = str_name[strsearch(str_name,"*",0)+1,inf]	str_name2 = $str_sort[var_ref]	str_name2 = str_name2[strsearch(str_name2,"*",0)+1,inf]	if(itemsinlist(str_list)>0 && itemsinlist(str_idxlist)>0)		print str_name+" found"		print replacestring(";",str_list,"\r")		print str_name2+" found"		print replacestring(";",str_idxlist,"\r")		make/o/n=(0,0) $(str_output+str_name+"_data")		make/o/n=(0) $(str_output+str_name2+"_idx")		var_index = 0		do			var_start = dimsize($(str_output+str_name+"_data"),1)			var_stop = dimsize($(str_output+str_name+"_data"),1)+dimsize($stringfromlist(var_index,str_list),1)-1			redimension/n=(dimsize($stringfromlist(var_index,str_list),0),dimsize($(str_output+str_name+"_data"),1)+dimsize($stringfromlist(var_index,str_list),1)) $(str_output+str_name+"_data")			$(str_output+str_name+"_data")[][var_start,var_stop] = $stringfromlist(var_index,str_list)[p][q-var_start]			var_start2 = dimsize($(str_output+str_name2+"_idx"),0)			var_stop2 = dimsize($(str_output+str_name2+"_idx"),0)+dimsize($stringfromlist(var_index,str_idxlist),0)-1			redimension/n=(dimsize($(str_output+str_name2+"_idx"),0)+dimsize($stringfromlist(var_index,str_idxlist),0)) $(str_output+str_name2+"_idx")			$(str_output+str_name2+"_idx")[var_start2,var_stop2] = $stringfromlist(var_index,str_idxlist)[p-var_start2]			var_index+=1		while(var_index<itemsinlist(str_list))	else		print str_name+" empty or "+str_name2+" empty"	endif	var_ref+=1while(var_ref<numpnts($str_input))end