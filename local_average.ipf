#pragma rtGlobals=1macro local_average()plocal_average()proc plocal_average(str_input,str_target,str_span,str_output)string str_inputprompt str_input "input waves ?"string str_targetprompt str_target "target point ?"string str_spanprompt str_span "average span ?"string str_outputprompt str_output "output wave ?"string str_listvariable var_indexstr_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")print "start:"print floor(str2num(str_target)-0.5*str2num(str_span))print "stop:"print ceil(str2num(str_target)+0.5*str2num(str_span))silent 1pauseupdatemake/o/n=(itemsinlist(str_list)) $str_output = nanvar_index = 0do		wavestats/q/r=[floor(str2num(str_target)-0.5*str2num(str_span)),ceil(str2num(str_target)+0.5*str2num(str_span))] $stringfromlist(var_index,str_list)	$str_output[var_index] = v_avg	setdimlabel 0,var_index,$stringfromlist(var_index,str_list),$str_output	var_index+=1while(var_index<itemsinlist(str_list))resumeupdateend