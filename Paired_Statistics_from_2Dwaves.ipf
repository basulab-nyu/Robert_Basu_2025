#pragma rtGlobals=1#include <Waves Average>macro Paired_Statistics_from_2Dwaves()pPaired_Statistics_from_2Dwaves()proc pPaired_Statistics_from_2Dwaves(str_input,str_output)string str_inputprompt str_input "input waves ?"string str_outputprompt str_output "output wave ?"string str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")killwaves/z $str_output,$(str_output+"_xlbl"),$(str_output+"_ylbl"),$(str_output+"_xloc"),$(str_output+"_yloc")make/o/n=(itemsinlist(str_list),6) $str_outputmake/t/o/n=(itemsinlist(str_list)) $(str_output+"_xlbl")make/t/o/n=(3) $(str_output+"_ylbl")make/o/n=(itemsinlist(str_list)) $(str_output+"_xloc")make/o/n=(3) $(str_output+"_yloc")setdimlabel 1,0,mean_diff,$str_outputsetdimlabel 1,1,t_test_p_value,$str_outputsetdimlabel 1,2,wsr_test_p_value,$str_outputvariable var_mean1variable var_mean2variable var_index = 0do	make/o/n=(dimsize($stringfromlist(var_index,str_list),0)) temp1 = $stringfromlist(var_index,str_list)[p][0]	make/o/n=(dimsize($stringfromlist(var_index,str_list),0)) temp2 = $stringfromlist(var_index,str_list)[p][1]	wavestats/q temp1	var_mean1 = v_avg	wavestats/q temp2	var_mean2 = v_avg	$str_output[var_index][0] = var_mean1 - var_mean2	statsttest/pair temp1,temp2	$str_output[var_index][1] = w_statsttest[%p]	statswilcoxonranktest/wsrt temp1,temp2	$str_output[var_index][2] = w_wilcoxontest[%p_two_tail]	setdimlabel 0,var_index,$(stringfromlist(var_index,str_list)+"_"+getdimlabel($stringfromlist(var_index,str_list),1,0)+"_vs_"+stringfromlist(var_index,str_list)+"_"+getdimlabel($stringfromlist(var_index,str_list),1,1)),$str_output	$(str_output+"_xlbl")[var_index] = stringfromlist(var_index,str_list)+"_"+getdimlabel($stringfromlist(var_index,str_list),1,0)+"_vs_"+stringfromlist(var_index,str_list)+"_"+getdimlabel($stringfromlist(var_index,str_list),1,1)	killwaves/z temp1,temp2,w_statsttest,w_wilcoxonTest	var_index+=1while(var_index<itemsinlist(str_list))$str_output[][3] = 0$str_output[][4] = 1$str_output[][5] = 2$(str_output+"_ylbl")[0] = "diff"$(str_output+"_ylbl")[1] = "p_Ttest"$(str_output+"_ylbl")[2] = "p_WSRT"$(str_output+"_xloc") = x$(str_output+"_yloc") = xdisplayappendtograph $str_output[][3]modifygraph mode($str_output)=3,marker($str_output)=9,mrkThick($str_output)=5,msize($str_output)=10,zColor($str_output)={$str_output[*][0],-1,1,CyanMagenta,1}appendtograph $str_output[][4]modifygraph mode($(str_output+"#1"))=3,marker($(str_output+"#1"))=9,mrkThick($(str_output+"#1"))=5,msize($(str_output+"#1"))=10,zColor($(str_output+"#1"))={$str_output[*][1],0,0.05,Rainbow,0},zColorMax($(str_output+"#1"))=(0,0,0)appendtograph $str_output[][5]modifygraph mode($(str_output+"#2"))=3,marker($(str_output+"#2"))=9,mrkThick($(str_output+"#2"))=5,msize($(str_output+"#2"))=10,zColor($(str_output+"#2"))={$str_output[*][2],0,0.05,Rainbow,0},zColorMax($(str_output+"#2"))=(0,0,0)modifygraph userticks(bottom)={$(str_output+"_xloc"),$(str_output+"_xlbl")}modifygraph userticks(left)={$(str_output+"_yloc"),$(str_output+"_ylbl")}modifygraph tkLblRot(bottom)=0modifygraph fSize(bottom)=8modifygraph swapXY=1modifygraph grid(left)=1colorscale/c/n=diff/f=0/a=mb/b=1/x=-200/y=-15 vert=0,trace=$str_output, "diff"colorscale/c/n=pval/f=0/a=mb/b=1/x=-100/y=-15 vert=0,trace=$(str_output+"#1"),axisRange={0,0.06},lowTrip=0.01, "p value"movewindow 200,40,800,475end