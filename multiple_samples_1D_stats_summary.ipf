#pragma rtGlobals=1macro multiple_samples_1D_stats_summary()pmultiple_samples_1D_stats_summary()proc pmultiple_samples_1D_stats_summary(str_input,str_output)string str_inputprompt str_input "input waves ?"string str_outputprompt str_output "output waves ?"string str_liststring str_catch_startstring str_catch_starstring str_catch_endstring str_labelstring str_label_xstring str_label_yvariable var_indexvariable var_pairstr_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")splitstring/e="(.+)([\*])(.+)" str_input,str_catch_start,str_catch_star,str_catch_endmake/o/n=(12,itemsinlist(str_list)) $str_output = nansetdimlabel 0,0,avg,$str_outputsetdimlabel 0,1,sem,$str_outputsetdimlabel 0,2,n_nonNaN,$str_outputsetdimlabel 0,3,n_total,$str_outputsetdimlabel 0,4,shapiro_wilk,$str_outputsetdimlabel 0,5,jarque_bera,$str_outputsetdimlabel 0,6,homoscedasticity,$str_outputsetdimlabel 0,7,anova1,$str_outputsetdimlabel 0,8,kruskall_wallis_chi,$str_outputsetdimlabel 0,9,kruskall_wallis_wallace,$str_outputsetdimlabel 0,10,anova2rm,$str_outputsetdimlabel 0,11,friedman,$str_outputvar_pair = 1var_index = 0do	str_label = ""	str_label = stringfromlist(var_index,str_list)	str_label = replacestring(str_catch_start,str_label,"")	str_label = replacestring(str_catch_end,str_label,"")	setdimlabel 1,var_index,$str_label,$str_output	wavestats/q $stringfromlist(var_index,str_list)	$str_output[0][var_index] = v_avg	$str_output[1][var_index] = v_sem	$str_output[2][var_index] = v_npnts	$str_output[3][var_index] = v_npnts+v_numnans+v_numinfs	killvariables/z v_prob	statsshapirowilktest/q/z $stringfromlist(var_index,str_list)	if(v_prob < 0.05)		$str_output[4][var_index] = 0	else		$str_output[4][var_index] = 1	endif	killwaves/z W_JBResults	statsjbtest/q/z $stringfromlist(var_index,str_list)	if(w_jbresults[%JBStatistic] >= w_jbresults[%Critical])		$str_output[5][var_index] = 0	else		$str_output[5][var_index] = 1	endif	if($str_output[2][0] != $str_output[2][var_index])		var_pair = 0	endif	var_index+=1while(var_index<itemsinlist(str_list))killwaves/z w_statsvariancesteststatsvariancestest/q/z/wstr=str_listif(w_statsvariancestest[%Bartlett_T] >= w_statsvariancestest[%Critical])	$str_output[6][0] = 0else	$str_output[6][0] = 1endifkillwaves/z m_anova1statsanova1test/q/z/wstr=str_list$str_output[7][0] = m_anova1[%Total][%P]killwaves/z w_kwtestresultsstatskwtest/q/z/wstr=str_list$str_output[8][0] = w_kwtestresults[%P_Chi_square_approx]$str_output[9][0] = w_kwtestresults[%P_Wallace_approx]if(var_pair == 1)	killwaves/z m_anova2rmresults	make/o/n=($str_output[2][0],itemsinlist(str_list)) temp2D = nan	var_index = 0	do		temp2D[][var_index] = $stringfromlist(var_index,str_list)[p]		var_index+=1	while(var_index<itemsinlist(str_list))	statsanova2rmtest/q/z temp2D	$str_output[10][0] = 1-statsfcdf(m_anova2rmresults[%Test_H0][%F],m_anova2rmresults[%Groups][%DF],m_anova2rmresults[%Remainder][%DF])	killwaves/z temp2D	killwaves/z m_friedmantestresults	statsfriedmantest/q/z/wstr=str_list	$str_output[11][0] = 1-statsfriedmancdf(m_friedmantestresults[0][%Statistic],m_friedmantestresults[0][%Columns],m_friedmantestresults[0][%Rows],1,1)endifkillwaves/z m_tukeytestresults,t_tukeydescriptorsstatstukeytest/q/z/swn/wstr=str_listredimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output$str_output[dimsize($str_output,0)-1][] = nansetdimlabel 0,dimsize($str_output,0)-1,tukey,$str_outputmake/o/n=(itemsinlist(str_list),itemsinlist(str_list)) $(str_output+"_tuk_pvalue_matrix") = nanvar_index = 0do	str_label = ""	str_label = stringfromlist(var_index,str_list)	str_label = replacestring(str_catch_start,str_label,"")	str_label = replacestring(str_catch_end,str_label,"")	setdimlabel 0,var_index,$str_label,$(str_output+"_tuk_pvalue_matrix")	setdimlabel 1,var_index,$str_label,$(str_output+"_tuk_pvalue_matrix")	var_index+=1while(var_index<itemsinlist(str_list))var_index = 0do	redimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output	$str_output[dimsize($str_output,0)-1][] = nan	$str_output[dimsize($str_output,0)-1][0] = m_tukeytestresults[var_index][%P]	str_label = ""	str_label = t_tukeydescriptors[var_index]	str_label = replacestring(str_catch_start,str_label,"")	str_label = replacestring(str_catch_end,str_label,"")	setdimlabel 0,dimsize($str_output,0)-1,$str_label,$str_output	str_label_x = str_label[0,strsearch(str_label," vs ",0)-1]	str_label_y = str_label[strsearch(str_label," vs ",0)+strlen(" vs "),inf]	if(finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_x) < finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_y))		$(str_output+"_tuk_pvalue_matrix")[finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_x)][finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_y)] = $str_output[dimsize($str_output,0)-1][0]	else		$(str_output+"_tuk_pvalue_matrix")[finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_y)][finddimlabel($(str_output+"_tuk_pvalue_matrix"),0,str_label_x)] = $str_output[dimsize($str_output,0)-1][0]	endif	var_index+=1while(var_index<dimsize(m_tukeytestresults,0))killwaves/z m_npmctukeyresults,t_npmctukeydescriptors,m_npmcdhwresults,t_npmcdhwdescriptorsstatsnpmctest/q/z/tuk/dhw/swn/wstr=str_listredimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output$str_output[dimsize($str_output,0)-1][] = nansetdimlabel 0,dimsize($str_output,0)-1,nemenyi,$str_outputmake/o/n=(itemsinlist(str_list),itemsinlist(str_list)) $(str_output+"_nmy_pvalue_matrix") = nanvar_index = 0do	str_label = ""	str_label = stringfromlist(var_index,str_list)	str_label = replacestring(str_catch_start,str_label,"")	str_label = replacestring(str_catch_end,str_label,"")	setdimlabel 0,var_index,$str_label,$(str_output+"_nmy_pvalue_matrix")	setdimlabel 1,var_index,$str_label,$(str_output+"_nmy_pvalue_matrix")	var_index+=1while(var_index<itemsinlist(str_list))if(v_flag != 1)	var_index = 0	do		redimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output		$str_output[dimsize($str_output,0)-1][] = nan		$str_output[dimsize($str_output,0)-1][0] = 1-statsqcdf(m_npmctukeyresults[var_index][%q],1,itemsinlist(str_list),itemsinlist(str_list)*($str_output[2][0]-1))		str_label = ""		str_label = t_npmctukeydescriptors[var_index]		str_label = replacestring(str_catch_start,str_label,"")		str_label = replacestring(str_catch_end,str_label,"")		setdimlabel 0,dimsize($str_output,0)-1,$str_label,$str_output		str_label_x = str_label[0,strsearch(str_label,"_vs_",0)-1]		str_label_y = str_label[strsearch(str_label,"_vs_",0)+strlen("_vs_"),inf]		if(finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_x) < finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_y))			$(str_output+"_nmy_pvalue_matrix")[finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_x)][finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_y)] = $str_output[dimsize($str_output,0)-1][0]		else			$(str_output+"_nmy_pvalue_matrix")[finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_y)][finddimlabel($(str_output+"_nmy_pvalue_matrix"),0,str_label_x)] = $str_output[dimsize($str_output,0)-1][0]		endif		var_index+=1	while(var_index<dimsize(m_npmctukeyresults,0))endifredimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output$str_output[dimsize($str_output,0)-1][] = nansetdimlabel 0,dimsize($str_output,0)-1,dunn_holland_wolfe,$str_outputmake/o/n=(itemsinlist(str_list),itemsinlist(str_list)) $(str_output+"_dhw_pvalue_matrix") = nanvar_index = 0do	str_label = ""	str_label = stringfromlist(var_index,str_list)	str_label = replacestring(str_catch_start,str_label,"")	str_label = replacestring(str_catch_end,str_label,"")	setdimlabel 0,var_index,$str_label,$(str_output+"_dhw_pvalue_matrix")	setdimlabel 1,var_index,$str_label,$(str_output+"_dhw_pvalue_matrix")	var_index+=1while(var_index<itemsinlist(str_list))var_index = 0do	redimension/n=(dimsize($str_output,0)+1,dimsize($str_output,1)) $str_output	$str_output[dimsize($str_output,0)-1][] = nan	$str_output[dimsize($str_output,0)-1][0] = 1-statsqcdf(m_npmcdhwresults[var_index][%q],1,itemsinlist(str_list),itemsinlist(str_list)*($str_output[2][0]-1))	str_label = ""	str_label = t_npmcdhwdescriptors[var_index]	str_label = replacestring(str_catch_start,str_label,"")	str_label = replacestring(str_catch_end,str_label,"")	setdimlabel 0,dimsize($str_output,0)-1,$str_label,$str_output	str_label_x = str_label[0,strsearch(str_label,"_vs_",0)-1]	str_label_y = str_label[strsearch(str_label,"_vs_",0)+strlen("_vs_"),inf]	if(finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_x) < finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_y))		$(str_output+"_dhw_pvalue_matrix")[finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_x)][finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_y)] = $str_output[dimsize($str_output,0)-1][0]	else		$(str_output+"_dhw_pvalue_matrix")[finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_y)][finddimlabel($(str_output+"_dhw_pvalue_matrix"),0,str_label_x)] = $str_output[dimsize($str_output,0)-1][0]	endif	var_index+=1while(var_index<dimsize(m_npmcdhwresults,0))edit $str_output.ldmovewindow 0,45,350,350killwaves/z W_JBResultskillwaves/z w_statsvariancestestkillwaves/z m_anova1killwaves/z w_kwtestresultskillwaves/z m_anova2rmresultskillwaves/z m_friedmantestresultskillwaves/z m_tukeytestresults,t_tukeydescriptorskillwaves/z m_npmctukeyresults,t_npmctukeydescriptors,m_npmcdhwresults,t_npmcdhwdescriptorsend