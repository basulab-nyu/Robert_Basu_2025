#pragma rtGlobals=1Macro Replace_String_in_Folders_from_Textwaves()pReplace_String_in_Folders_from_Textwaves()proc pReplace_String_in_Folders_from_Textwaves(str_input,str_output)string str_inputprompt str_input "input textwave ?"string str_outputprompt str_input "output textwave ?"if(strlen(str_input) == 0)	str_input = "w_folder_list"endifif(strlen(str_output) == 0)	str_output = "w_wave_list"endifstring str_folderstring str_wavestring str_listvariable var_indexvariable var_index2setdatafolder root:silent 1pauseupdatestr_folder = ""var_index = 0do	str_folder = $str_input[var_index]	str_wave = $str_output[var_index]	print "working on:"	print str_folder	print str_wave	setdatafolder root:$str_folder	str_list = ""	str_list = sortlist(wavelist("*"+str_wave+"*",";",""),";",16)	var_index2 = 0	do		print "renaming..."		print stringfromlist(var_index2,str_list)		print replacestring(str_wave,stringfromlist(var_index2,str_list),str_folder)		rename $stringfromlist(var_index2,str_list),$replacestring(str_wave,stringfromlist(var_index2,str_list),str_folder)		var_index2+=1	while(var_index2<itemsinlist(str_list))	setdatafolder root:	var_index+=1while(var_index<numpnts($str_input))print "done !!!"end