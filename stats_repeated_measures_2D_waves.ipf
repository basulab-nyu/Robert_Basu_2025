#pragma rtGlobals=1macro stats_repeated_measures_2D_waves()pstats_repeated_measures_2D_waves()proc pstats_repeated_measures_2D_waves(str_input,str_dim,str_output)string str_inputprompt str_input "input waves (2D) ?"string str_dimprompt str_dim "groups dimension ?"string str_outputprompt str_output "output wave ?"if(strlen(str_dim) == 0)	str_dim = "0"endifstring str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")variable var_indexvariable var_index1make/o/n=(itemsinlist(str_list),2) $str_output = nansetdimlabel 1,0,anova2rm,$str_outputsetdimlabel 1,1,friedman,$str_outputvar_index = 0do	duplicate/o $stringfromlist(var_index,str_list) temp	if(str2num(str_dim) == 0)		matrixtranspose temp	endif	make/o/n=(0) tempnonan	var_index1 = 0	do		duplicate/o/r=[var_index1][] temp temprow		matrixtranspose temprow		redimension/n=-1 temprow		wavestats/q temprow		if(v_numnans == 0)			redimension/n=(dimsize(tempnonan,0)+1,dimsize(temp,1)) tempnonan			tempnonan[dimsize(tempnonan,0)-1][] = temp[var_index1][q]		endif		var_index1+=1	while(var_index1<dimsize(temp,0))	killwaves/z M_ANOVA2RMResults	statsanova2rmtest/q tempnonan	$str_output[var_index][0] = 1-statsfcdf(M_ANOVA2RMResults[%Test_H0][%F],M_ANOVA2RMResults[%Groups][%DF],M_ANOVA2RMResults[%Remainder][%DF])	killwaves/z M_FriedmanTestResults	statsfriedmantest/q tempnonan	$str_output[var_index][1] = 1-statsfriedmancdf(M_FriedmanTestResults[0][%Statistic],M_FriedmanTestResults[0][%Columns],M_FriedmanTestResults[0][%Rows],0,1) 	setdimlabel 0,var_index,$stringfromlist(var_index,str_list),$str_output	killwaves/z temp,temprow,tempnonan,M_ANOVA2RMResults,M_FriedmanTestResults	var_index+=1while(var_index<itemsinlist(str_list))end