#pragma rtGlobals=1Macro bin_data_rows_period()pbin_data_rows_period()proc pbin_data_rows_period(str_input,str_sweep,str_output)string str_inputprompt str_input "input waves ?"string str_sweepprompt str_sweep "index period ?"string str_outputprompt str_output "output waves ?"string str_liststr_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")variable var_indexvariable var_index1variable var_index2silent 1pauseupdatevar_index = 0do	make/o/n=(str2num(str_sweep),dimsize($stringfromlist(var_index,str_list),1)) $(stringfromlist(var_index,str_list)+"_"+str_output) = nan	var_index2 = 0	do		var_index1 = 0		do			make/o/n=(dimsize($stringfromlist(var_index,str_list),0)/str2num(str_sweep)) tempbin = $stringfromlist(var_index,str_list)[var_index1+str2num(str_sweep)*p][var_index2]			wavestats/q tempbin			$(stringfromlist(var_index,str_list)+"_"+str_output)[var_index1][var_index2] = v_avg			setdimlabel 0,var_index1,$getdimlabel($stringfromlist(var_index,str_list),0,var_index1),$(stringfromlist(var_index,str_list)+"_"+str_output)			var_index1+=1		while(var_index1<str2num(str_sweep))		var_index2+=1	while(var_index2<dimsize($stringfromlist(var_index,str_list),1))	var_index+=1while(var_index<itemsinlist(str_list))killwaves/z tempbinresumeupdateend