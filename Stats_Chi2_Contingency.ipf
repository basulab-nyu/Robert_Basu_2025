#pragma rtGlobals=1		// Use modern global access method.#include <Waves Average>macro Stats_Chi2_Contingency()pStats_Chi2_Contingency()proc pStats_Chi2_Contingency(str_input)string str_inputprompt str_input "input waves ?"string str_list = sortlist (wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")string str_output = replacestring("*",str_input,"")variable var_indexvariable var_index1make/o/n=(dimsize($stringfromlist(0,str_list),0),itemsinlist(str_list)) $(str_output+"_obs")make/o/n=(dimsize($stringfromlist(0,str_list),0),itemsinlist(str_list)) $(str_output+"_exp")copydimlabels/rows=0 $stringfromlist(0,str_list),$(str_output+"_obs")copydimlabels/rows=0 $stringfromlist(0,str_list),$(str_output+"_exp")silent 1pauseupdatevar_index = 0do	$(str_output+"_obs")[][var_index] = $stringfromlist(var_index,str_list)[p]	setdimlabel 1,var_index,$nameofwave($stringfromlist(var_index,str_list)),$(str_output+"_obs")	setdimlabel 1,var_index,$nameofwave($stringfromlist(var_index,str_list)),$(str_output+"_exp")	var_index+=1while(var_index<itemsinlist(str_list))sumdimension/d=0/dest=tempx $(str_output+"_obs")sumdimension/d=1/dest=tempy $(str_output+"_obs")var_index = 0do	var_index1 = 0	do		$(str_output+"_exp")[var_index1][var_index] = tempx[var_index]*tempy[var_index1]/(max(sum(tempx),sum(tempy)))		var_index1+=1	while(var_index1<dimsize($(str_output+"_exp"),0))	var_index+=1while(var_index<dimsize($(str_output+"_exp"),1))statschitest/q/s $(str_output+"_obs"),$(str_output+"_exp")duplicate/o W_StatsChiTest,$(str_output+"_chi2")statscontingencytable/q $(str_output+"_obs")duplicate/o W_ContingencyTableResults,$(str_output+"_contingency")edit $(str_output+"_chi2").ld,$(str_output+"_contingency").ldrename $(str_output+"_obs"),$replacestring("__",(str_output+"_obs"),"_")rename $(str_output+"_exp"),$replacestring("__",(str_output+"_exp"),"_")rename $(str_output+"_chi2"),$replacestring("__",(str_output+"_chi2"),"_")rename $(str_output+"_contingency"),$replacestring("__",(str_output+"_contingency"),"_")killwaves/z W_StatsChiTest,W_ContingencyTableResults,tempx,tempyresumeupdateend