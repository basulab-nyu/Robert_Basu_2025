#pragma rtGlobals=1Macro zapnans_matrix_textwave()pzapnans_matrix_textwave()proc pzapnans_matrix_textwave(str_num,str_txt)string str_numprompt str_num "input numwaves ?"string str_txtprompt str_txt "input textwaves ?"string str_numlist = sortlist(wavelist(str_num,";",""),";",16)string str_txtlist = sortlist(wavelist(str_txt,";",""),";",16)print replacestring(";",str_numlist,"\r")print replacestring(";",str_txtlist,"\r")variable var_indexvariable var_index1variable var_index2variable var_maxvar_index = 0do	var_max = 0	var_index1 = 0	do		duplicate/o/r=[][var_index1] $stringfromlist(var_index,str_numlist),temp		redimension/n=-1 temp		wavetransform zapnans temp		var_max = max(var_max,numpnts(temp))		var_index1+=1	while(var_index1<dimsize($stringfromlist(var_index,str_numlist),1))	make/o/n=(var_max,dimsize($stringfromlist(var_index,str_numlist),1)) $(stringfromlist(var_index,str_numlist)+"_noNaNs") = nan	make/o/t/n=(var_max,dimsize($stringfromlist(var_index,str_txtlist),1)) $(stringfromlist(var_index,str_txtlist)+"_noNaNs")	var_index1 = 0	do		duplicate/o/r=[][var_index1] $stringfromlist(var_index,str_numlist),temp		redimension/n=-1 temp		wavetransform zapnans temp		$(stringfromlist(var_index,str_numlist)+"_noNaNs")[0,numpnts(temp)-1][var_index1] = temp[p]		duplicate/o/r=[][var_index1] $stringfromlist(var_index,str_txtlist),temp2		extract/o temp2,temp2,strlen(temp2)>0		$(stringfromlist(var_index,str_txtlist)+"_noNaNs")[0,numpnts(temp)-1][var_index1] = temp2[p]		var_index1+=1	while(var_index1<dimsize($stringfromlist(var_index,str_numlist),1))	var_index+=1while(var_index<itemsinlist(str_numlist))killwaves/z temp,temp2end