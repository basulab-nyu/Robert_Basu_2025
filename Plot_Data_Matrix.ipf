#pragma rtGlobals=1Macro Plot_Data_Matrix()pPlot_Data_Matrix()proc pPlot_Data_Matrix(str_input)string str_inputprompt str_input "input waves ?"string str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")string/g str_graph_list = sortlist(winlist("*",";","WIN:1"),";",16)string/g str_table_list = sortlist(winlist("*",";","WIN:2"),";",16)variable/g var_graph_last = itemsinlist(str_graph_list)-1string/g str_graph_last = winname(0,1)variable/g var_table_last = itemsinlist(str_table_list)-1string/g str_table_last = winname(0,2)getwindow $str_graph_last, wsizevariable/g var_left_g = v_left + 5.25variable/g var_top_g = v_top + 22.5variable/g var_right_g = v_right + 5.25variable/g var_bottom_g = v_bottom + 22.5getwindow $str_table_last, wsizevariable/g var_left_t = v_left + 5.25variable/g var_top_t = v_top + 22.5variable/g var_right_t = v_right + 5.25variable/g var_bottom_t = v_bottom + 22.5variable/g var_spacing = 0silent 1pauseupdateif(exists("str_Alist") == 2)		killstrings/z str_Alist	endif	string/g str_Alist	if(exists("str_Elist") == 2)		killstrings/z str_Elist	endif	string/g str_Elistvariable/g var_index = 0displaydo	if(exists("str_Dlist") == 2)		killstrings/z str_Dlist	endif	string/g str_Dlist	if(dimsize($stringfromlist(var_index,str_list),0) == 6)		make/o/n=6 x_elec_io = {25,50,75,100,150,200}		x_elec_io=0.5*x_elec_io	endif	if(dimsize($stringfromlist(var_index,str_list),0) == 19)		make/o/n=19 x_opto_io = {1,2,3,4,5,6,7,8,9,10,20,30,40,50,60,70,80,90,100}	endif	variable/g var_col = 0	do		duplicate/o/r=[][var_col] $stringfromlist(var_index,str_list) $(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D")		redimension/n=-1 $(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D")		if(strlen(str_Dlist) == 0)			str_Dlist = getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D"		else			str_Dlist = str_Dlist+";"+getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D"		endif		if(dimsize($stringfromlist(var_index,str_list),0) == 6)			appendtograph $(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D") vs x_elec_io		endif		if(dimsize($stringfromlist(var_index,str_list),0) == 19)			appendtograph $(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D") vs x_opto_io		endif		if(dimsize($stringfromlist(var_index,str_list),0) != 6 && dimsize($stringfromlist(var_index,str_list),0) != 19)			appendtograph $(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D")		endif		if(grepstring(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D","_Le_") == 1)			modifygraph rgb($(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D")) = (2,39321,1,32768)		endif		if(grepstring(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D","_Li_") == 1)			modifygraph rgb($(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D")) = (65535,0,0,32768)		endif		if(grepstring(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D","_SM_") == 1)			modifygraph rgb($(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D")) = (34952,34952,34952,32768)		endif		if(grepstring(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D","_MF_") == 1)			modifygraph rgb($(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D")) = (39321,13101,1,32768)		endif		if(grepstring(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D","_RC_") == 1)			modifygraph rgb($(getdimlabel($stringfromlist(var_index,str_list),1,var_col)+"_D")) = (0,0,0,32768)		endif		var_col+=1	while(var_col<dimsize($stringfromlist(var_index,str_list),1))	if(exists(stringfromlist(var_index,str_list)+"_avg") == 1)		killwaves/z $(stringfromlist(var_index,str_list)+"_avg")	endif	if(exists(stringfromlist(var_index,str_list)+"_sem") == 1)		killwaves/z $(stringfromlist(var_index,str_list)+"_sem")	endif	fWaveAverage(str_Dlist,"",3,0,stringfromlist(var_index,str_list)+"_avg",stringfromlist(var_index,str_list)+"_sem")	if(strlen(str_Alist) == 0)		str_Alist = stringfromlist(var_index,str_list)+"_avg"	else		str_Alist = str_Alist+";"+stringfromlist(var_index,str_list)+"_avg"	endif	if(strlen(str_Elist) == 0)		str_Elist = stringfromlist(var_index,str_list)+"_sem"	else		str_Elist = str_Elist+";"+stringfromlist(var_index,str_list)+"_sem"	endif	var_index+=1while(var_index<itemsinlist(str_list))variable/g var_index = 0do	if(dimsize($stringfromlist(var_index,str_Alist),0) == 6)			appendtograph $stringfromlist(var_index,str_Alist) vs x_elec_io		endif		if(dimsize($stringfromlist(var_index,str_Alist),0) == 19)			appendtograph $stringfromlist(var_index,str_Alist) vs x_opto_io		endif		if(dimsize($stringfromlist(var_index,str_Alist),0) != 6 && dimsize($stringfromlist(var_index,str_list),0) != 19)			appendtograph $stringfromlist(var_index,str_Alist)		endif		errorbars $stringfromlist(var_index,str_Alist),Y wave=($stringfromlist(var_index,str_Elist),$stringfromlist(var_index,str_Elist))		modifygraph mode($stringfromlist(var_index,str_Alist))=3,marker($stringfromlist(var_index,str_Alist))=19,msize($stringfromlist(var_index,str_Alist))=4		if(grepstring(stringfromlist(var_index,str_Alist),"_Le_") == 1)			modifygraph rgb($stringfromlist(var_index,str_Alist)) = (2,39321,1)		endif		if(grepstring(stringfromlist(var_index,str_Alist),"_Li_") == 1)			modifygraph rgb($stringfromlist(var_index,str_Alist)) = (65535,0,0)		endif		if(grepstring(stringfromlist(var_index,str_Alist),"_SM_") == 1)			modifygraph rgb($stringfromlist(var_index,str_Alist)) = (34952,34952,34952)		endif		if(grepstring(stringfromlist(var_index,str_Alist),"_MF_") == 1)			modifygraph rgb($stringfromlist(var_index,str_Alist)) = (39321,13101,1)		endif		if(grepstring(stringfromlist(var_index,str_Alist),"_RC_") == 1)			modifygraph rgb($stringfromlist(var_index,str_Alist)) = (0,0,0)		endif	var_index+=1while(var_index<itemsinlist(str_Alist))resumeupdatemovewindow var_left_g,var_top_g,var_right_g,var_bottom_gend