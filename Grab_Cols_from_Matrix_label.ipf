#pragma rtGlobals=1		// Use modern global access method.#include <Waves Average>macro Grab_Cols_from_Matrix_label()pGrab_Cols_from_Matrix_label()proc pGrab_Cols_from_Matrix_label(str_input,str_label)string str_inputprompt str_input "input waves ?"string str_labelprompt str_label "label target ?"string str_list = sortlist (wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")variable var_indexvariable var_index1variable var_index2silent 1pauseupdatevar_index = 0do	make/o/n=(dimsize($stringfromlist(var_index,str_list),0)) $(stringfromlist(var_index,str_list)+"_"+replacestring("*",str_label,"")) = nan	var_index1 = 0	var_index2 = dimsize($(stringfromlist(var_index,str_list)+"_"+replacestring("*",str_label,"")),1)	do		if(stringmatch(getdimlabel($stringfromlist(var_index,str_list),1,var_index1),str_label) == 1)			redimension/n=(dimsize($(stringfromlist(var_index,str_list)+"_"+replacestring("*",str_label,"")),0),var_index2+1) $(stringfromlist(var_index,str_list)+"_"+replacestring("*",str_label,""))			$(stringfromlist(var_index,str_list)+"_"+replacestring("*",str_label,""))[][var_index2] = $stringfromlist(var_index,str_list)[p][var_index1]			setdimlabel 1,var_index2,$getdimlabel($stringfromlist(var_index,str_list),1,var_index1),$(stringfromlist(var_index,str_list)+"_"+replacestring("*",str_label,""))			var_index2+=1		endif		var_index1+=1	while(var_index1<dimsize($stringfromlist(var_index,str_list),1))	var_index+=1while(var_index<itemsinlist(str_list))resumeupdateend