#pragma rtGlobals=1Macro Concatenate_Matching_Waves()pConcatenate_Matching_Waves()proc pConcatenate_Matching_Waves(str_input,str_target,str_match,str_dim,str_output)string str_inputprompt str_input "input waves ?"string str_targetprompt str_target "target string ?"string str_matchprompt str_match "matching string ?"string str_dimprompt str_dim "concatenation dimension ?"string str_outputprompt str_output "output waves ?"if(strlen(str_dim) == 0)	variable/g var_dim = 0else	variable/g var_dim = str2num(str_dim)endifstring/g str_list = sortlist(wavelist(str_input,";",""),";",16)print "input waves:"print replacestring(";",str_list,"\r")string/g str_list2 = replacestring(str_target,str_list,str_match)print "matching waves:"print replacestring(";",str_list2,"\r")variable/g var_index = 0do	concatenate/np=(var_dim)/o/dl stringfromlist(var_index,str_list)+";"+stringfromlist(var_index,str_list2)+";", $(stringfromlist(var_index,str_list)+"_"+str_output)	var_index+=1while(var_index<itemsinlist(str_list))end