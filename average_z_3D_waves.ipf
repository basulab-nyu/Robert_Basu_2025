#pragma rtGlobals=1macro average_z_3D_waves()paverage_z_3D_waves()proc paverage_z_3D_waves(str_input)string str_inputprompt str_input "input waves ?"string str_listvariable var_indexvariable var_index1variable var_index2str_list = sortlist(wavelist(str_input,";",""),";",16)print replacestring(";",str_list,"\r")silent 1pauseupdatevar_index = 0do	make/o/n=(dimsize($stringfromlist(var_index,str_list),0),dimsize($stringfromlist(var_index,str_list),1)) $(stringfromlist(var_index,str_list)+"_z_avg") = nan	make/o/n=(dimsize($stringfromlist(var_index,str_list),0),dimsize($stringfromlist(var_index,str_list),1)) $(stringfromlist(var_index,str_list)+"_z_sem") = nan	copydimlabels/rows=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_z_avg")	copydimlabels/rows=0 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_z_sem")	copydimlabels/cols=1 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_z_avg")	copydimlabels/cols=1 $stringfromlist(var_index,str_list),$(stringfromlist(var_index,str_list)+"_z_sem")	duplicate/o $stringfromlist(var_index,str_list) work	var_index1 = 0	do		var_index2 = 0		do			matrixop/o temp = beam(work,var_index1,var_index2)			wavestats/q temp			$(stringfromlist(var_index,str_list)+"_z_avg")[var_index1][var_index2] = v_avg			$(stringfromlist(var_index,str_list)+"_z_sem")[var_index1][var_index2] = v_sem			var_index2+=1		while(var_index2<dimsize($stringfromlist(var_index,str_list),1))		var_index1+=1	while(var_index1<dimsize($stringfromlist(var_index,str_list),0))	var_index+=1while(var_index<itemsinlist(str_list))resumeupdatekillwaves/z temp,workend